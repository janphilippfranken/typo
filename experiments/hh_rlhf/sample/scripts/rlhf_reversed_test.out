[2024-01-27 23:22:36,963][root][INFO] - Parameters:
- Run ID: 1
- N Revisions: 50
- Batch Size: 1
- Num Return Sequences: 12
- N Eval Examples: 10
- N Generation Examples: 1
- Generation Prompt: prompt_1
- Evaluation Prompt: prompt_1

Storing as: ./constitutions/rlhf_reversed_test_mixtral_7b_base_run_1
INFO 01-27 23:22:42 llm_engine.py:70] Initializing an LLM engine with config: model='mistralai/Mixtral-8x7B-v0.1', tokenizer='mistralai/Mixtral-8x7B-v0.1', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/pretrained_models/Mixtral-8x7B-v0.1', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-27 23:23:01 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-27 23:23:02 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-27 23:23:02 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
[36m(RayWorkerVllm pid=2034852)[0m INFO 01-27 23:23:02 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=2034852)[0m INFO 01-27 23:23:02 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-27 23:23:37 model_runner.py:547] Graph capturing finished in 35 secs.
[2024-01-27 23:23:37,623][root][INFO] - Model Generate is mixtral_7b_base
[2024-01-27 23:23:37,624][root][INFO] - Model Eval is mixtral_7b_base
[36m(RayWorkerVllm pid=2034852)[0m INFO 01-27 23:23:37 model_runner.py:547] Graph capturing finished in 35 secs.
[2024-01-27 23:23:40,870][root][INFO] - Dataset is Anthropic/hh-rlhf. Version: rlhf_reversed_test, Chosen: rejected, Rejected: chosen
[2024-01-27 23:23:40,871][root][INFO] - Dataset({
    features: ['chosen', 'rejected'],
    num_rows: 1000
})
[2024-01-27 23:23:40,871][root][INFO] - Seed is 1
[2024-01-27 23:23:40,880][root][INFO] - Training Example(s): tensor([[507]], dtype=torch.int32)
[2024-01-27 23:23:40,880][root][INFO] - Random previous Example(s) used for Evaluation: [array([507], dtype=int32)]
[2024-01-27 23:24:00,980][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:24:00,981][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:24:00,981][root][INFO] - Formatted Response Success Rate: 0.8333333333333334
[2024-01-27 23:24:05,523][root][INFO] - New Constitution 0: 1. Provide contextual information when responding to inquiries.
2. Provide more specific location information when responding to inquiries.
3. Provide more information about a person's family members when responding to inquiries.
[2024-01-27 23:24:05,523][root][INFO] - Writing to disk.
[2024-01-27 23:24:05,538][root][INFO] - Training Example(s): tensor([[326]], dtype=torch.int32)
[2024-01-27 23:24:05,538][root][INFO] - Random previous Example(s) used for Evaluation: [array([507, 326], dtype=int32)]
[2024-01-27 23:24:25,217][root][INFO] - Formatted Response Success Rate: 1.0
[2024-01-27 23:24:29,926][root][INFO] - New Constitution 0: 1. Provide contextual information when responding to inquiries.
2. Provide more specific location information when responding to inquiries.
3. Provide more information about a person's family members when responding to inquiries.
4. Provide more information about the company's ESG assessment and any relevant news articles when responding to inquiries.
5. Provide a more specific and direct response to the human's question.
6. Ask the human if they are thinking of investing in the company to better understand their intentions and provide a more relevant response.
[2024-01-27 23:24:29,926][root][INFO] - Writing to disk.
[2024-01-27 23:24:29,937][root][INFO] - Training Example(s): tensor([[893]], dtype=torch.int32)
[2024-01-27 23:24:29,938][root][INFO] - Random previous Example(s) used for Evaluation: [array([893, 326, 507], dtype=int32)]
[2024-01-27 23:24:49,279][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:24:49,279][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:24:49,279][root][INFO] - Formatted Response Success Rate: 0.8333333333333334
[2024-01-27 23:24:56,539][root][INFO] - New Constitution 0: 1. Provide contextual information when responding to inquiries.
2. Provide more specific location information when responding to inquiries.
3. Provide more information about a person's family members when responding to inquiries.
4. Provide more information about the company's ESG assessment and any relevant news articles when responding to inquiries.
5. Provide a more specific and direct response to the human's question.
6. Ask the human if they are thinking of investing in the company to better understand their intentions and provide a more relevant response.
7. Clarify any ambiguous terms or phrases used by the human to ensure a clear understanding of their intentions.
8. Provide more information about the context of the human's question, such as the location or the type of prank being asked about, to generate a more relevant and useful response.
[2024-01-27 23:24:56,539][root][INFO] - Writing to disk.
[2024-01-27 23:24:56,551][root][INFO] - Training Example(s): tensor([[322]], dtype=torch.int32)
[2024-01-27 23:24:56,551][root][INFO] - Random previous Example(s) used for Evaluation: [array([893, 507, 326, 322], dtype=int32)]
[2024-01-27 23:25:16,212][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:25:16,212][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:25:16,212][root][INFO] - Formatted Response Success Rate: 0.8333333333333334
[2024-01-27 23:25:26,285][root][INFO] - Writing to disk.
[2024-01-27 23:25:26,296][root][INFO] - Training Example(s): tensor([[637]], dtype=torch.int32)
[2024-01-27 23:25:26,297][root][INFO] - Random previous Example(s) used for Evaluation: [array([507, 322, 893, 326, 637], dtype=int32)]
[2024-01-27 23:25:46,582][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:25:46,583][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:25:46,583][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:25:46,583][root][ERROR] - Error in format_response_base: local variable 'e' referenced before assignment
[2024-01-27 23:25:46,583][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:25:46,583][root][INFO] - Formatted Response Success Rate: 0.5833333333333334
[2024-01-27 23:26:03,748][root][INFO] - Writing to disk.
[2024-01-27 23:26:03,759][root][INFO] - Training Example(s): tensor([[217]], dtype=torch.int32)
[2024-01-27 23:26:03,759][root][INFO] - Random previous Example(s) used for Evaluation: [array([637, 893, 507, 322, 326, 217], dtype=int32)]
[2024-01-27 23:26:23,917][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:26:23,918][root][INFO] - Formatted Response Success Rate: 0.9166666666666666
[2024-01-27 23:26:41,797][root][INFO] - New Constitution 0: 1. Provide specific and direct responses to the human's questions.
2. Provide contextual information about the potential misuse of drones, including examples of harmful uses such as dropping bombs, attacking crowds, and being hijacked for ransomware or DDoS attacks.
3. Provide information about the potential political surveillance capabilities of drones.
4. Provide more information about the context of the human's question, such as the location or the type of prank being asked about, to generate a more relevant and useful response.
5. Provide more specific location information when responding to inquiries.
6. Provide more information about a person's family members when responding to inquiries.
7. Provide more information about the company's ESG assessment and any relevant news articles when responding to inquiries.
8. Clarify any ambiguous terms or phrases used by the human to ensure a clear understanding of their intentions.
[2024-01-27 23:26:41,798][root][INFO] - Writing to disk.
[2024-01-27 23:26:41,809][root][INFO] - Training Example(s): tensor([[392]], dtype=torch.int32)
[2024-01-27 23:26:41,809][root][INFO] - Random previous Example(s) used for Evaluation: [array([322, 326, 637, 893, 217, 392, 507], dtype=int32)]
[2024-01-27 23:27:01,701][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-27 23:27:01,701][root][INFO] - Formatted Response Success Rate: 0.9166666666666666
