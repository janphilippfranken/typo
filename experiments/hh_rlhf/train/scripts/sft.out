[2024-01-31 22:58:22,721][root][INFO] - Writing checkpoints to: /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/sft_helpful_chosen
[2024-01-31 22:58:22,721][root][INFO] - Wandb name: sft_helpful_chosen
[2024-01-31 22:58:22,721][root][INFO] - Max seq length: 2048
[2024-01-31 22:58:22,721][root][INFO] - Devices: 4
[2024-01-31 22:58:22,721][root][INFO] - Data: {'type': 'human', 'dataset': {'path': 'Anthropic/hh-rlhf', 'data_dir': 'helpful-base', 'cache_dir': '/scr/jphilipp/scai/datasets/hh-rlhf'}, 'split': 'train'}
[2024-01-31 22:58:22,724][root][INFO] - Writing checkpoints to: /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/sft_helpful_chosen
[2024-01-31 22:58:22,724][root][INFO] - Wandb name: sft_helpful_chosen
[2024-01-31 22:58:22,724][root][INFO] - Max seq length: 2048
[2024-01-31 22:58:22,724][root][INFO] - Devices: 4
[2024-01-31 22:58:22,724][root][INFO] - Data: {'type': 'human', 'dataset': {'path': 'Anthropic/hh-rlhf', 'data_dir': 'helpful-base', 'cache_dir': '/scr/jphilipp/scai/datasets/hh-rlhf'}, 'split': 'train'}
[2024-01-31 22:58:22,763][root][INFO] - Writing checkpoints to: /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/sft_helpful_chosen
[2024-01-31 22:58:22,763][root][INFO] - Wandb name: sft_helpful_chosen
[2024-01-31 22:58:22,763][root][INFO] - Max seq length: 2048
[2024-01-31 22:58:22,763][root][INFO] - Devices: 4
[2024-01-31 22:58:22,763][root][INFO] - Data: {'type': 'human', 'dataset': {'path': 'Anthropic/hh-rlhf', 'data_dir': 'helpful-base', 'cache_dir': '/scr/jphilipp/scai/datasets/hh-rlhf'}, 'split': 'train'}
[2024-01-31 22:58:22,780][root][INFO] - Writing checkpoints to: /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/sft_helpful_chosen
[2024-01-31 22:58:22,780][root][INFO] - Wandb name: sft_helpful_chosen
[2024-01-31 22:58:22,780][root][INFO] - Max seq length: 2048
[2024-01-31 22:58:22,780][root][INFO] - Devices: 4
[2024-01-31 22:58:22,781][root][INFO] - Data: {'type': 'human', 'dataset': {'path': 'Anthropic/hh-rlhf', 'data_dir': 'helpful-base', 'cache_dir': '/scr/jphilipp/scai/datasets/hh-rlhf'}, 'split': 'train'}
[2024-01-31 22:58:35,445] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-01-31 22:58:35,473] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-01-31 22:58:35,525] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-01-31 22:58:35,588] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-01-31 22:58:35,588] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-01-31 22:58:35,612] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-01-31 22:58:35,661] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-01-31 22:58:35,842] [INFO] [real_accelerator.py:161:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-01-31 22:58:35,984] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-01-31 22:58:40,395][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: Hi, I want to learn to play horseshoes. Can you teach me?

Assistant: I can, but maybe I should begin by telling you that a typical game consists of 2 players and 6 or 8 horseshoes.

Human: Okay. What else is needed to play, and what are the rules?

Assistant:
[2024-01-31 22:58:40,395][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: How do yo dig a trench?

Assistant: Digging a trench is hard work.  You’ll need to find a place that’s relatively level and won’t be muddy or icy, and then you have to start scooping out the dirt.  You’ll want to pile it to one side as you go, to keep the sides straight.  You want to dig a little deeper than the width of the pipe you’re burying, so you can use a hand auger to smooth the corners.  You can use a pick to stab the dirt to break up the mud or hard ground.  You can also put some wood in the hole before you put the pipe in, that’ll help you scoop out the dirt.

Human: I didn't say anything about laying down pipes but still your advice on trench digging was useful. Thank you.

Assistant:
[2024-01-31 22:58:40,396][root][INFO] - A horseshoe is usually made out of metal and is about 3 to 3.5 inches long and around 1 inch thick. The horseshoe should also have a 2 inch by 3 inch flat at the bottom where the rubber meets the metal. We also need two stakes and six horseshoes.
[2024-01-31 22:58:40,396][root][INFO] - Not a problem.  I hope you didn’t mind that I guessed you were doing some sort of home project.
[2024-01-31 22:58:40,622][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: Hi, I want to learn to play horseshoes. Can you teach me?

Assistant: I can, but maybe I should begin by telling you that a typical game consists of 2 players and 6 or 8 horseshoes.

Human: Okay. What else is needed to play, and what are the rules?

Assistant:
[2024-01-31 22:58:40,622][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: How do yo dig a trench?

Assistant: Digging a trench is hard work.  You’ll need to find a place that’s relatively level and won’t be muddy or icy, and then you have to start scooping out the dirt.  You’ll want to pile it to one side as you go, to keep the sides straight.  You want to dig a little deeper than the width of the pipe you’re burying, so you can use a hand auger to smooth the corners.  You can use a pick to stab the dirt to break up the mud or hard ground.  You can also put some wood in the hole before you put the pipe in, that’ll help you scoop out the dirt.

Human: I didn't say anything about laying down pipes but still your advice on trench digging was useful. Thank you.

Assistant:
[2024-01-31 22:58:40,623][root][INFO] - A horseshoe is usually made out of metal and is about 3 to 3.5 inches long and around 1 inch thick. The horseshoe should also have a 2 inch by 3 inch flat at the bottom where the rubber meets the metal. We also need two stakes and six horseshoes.
[2024-01-31 22:58:40,623][root][INFO] - Not a problem.  I hope you didn’t mind that I guessed you were doing some sort of home project.
[2024-01-31 22:58:40,854][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: Hi, I want to learn to play horseshoes. Can you teach me?

Assistant: I can, but maybe I should begin by telling you that a typical game consists of 2 players and 6 or 8 horseshoes.

Human: Okay. What else is needed to play, and what are the rules?

Assistant:
[2024-01-31 22:58:40,854][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: How do yo dig a trench?

Assistant: Digging a trench is hard work.  You’ll need to find a place that’s relatively level and won’t be muddy or icy, and then you have to start scooping out the dirt.  You’ll want to pile it to one side as you go, to keep the sides straight.  You want to dig a little deeper than the width of the pipe you’re burying, so you can use a hand auger to smooth the corners.  You can use a pick to stab the dirt to break up the mud or hard ground.  You can also put some wood in the hole before you put the pipe in, that’ll help you scoop out the dirt.

Human: I didn't say anything about laying down pipes but still your advice on trench digging was useful. Thank you.

Assistant:
[2024-01-31 22:58:40,854][root][INFO] - A horseshoe is usually made out of metal and is about 3 to 3.5 inches long and around 1 inch thick. The horseshoe should also have a 2 inch by 3 inch flat at the bottom where the rubber meets the metal. We also need two stakes and six horseshoes.
[2024-01-31 22:58:40,854][root][INFO] - Not a problem.  I hope you didn’t mind that I guessed you were doing some sort of home project.
[2024-01-31 22:58:41,066][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: Hi, I want to learn to play horseshoes. Can you teach me?

Assistant: I can, but maybe I should begin by telling you that a typical game consists of 2 players and 6 or 8 horseshoes.

Human: Okay. What else is needed to play, and what are the rules?

Assistant:
[2024-01-31 22:58:41,067][root][INFO] - System: Write a response for the assistant that completes the human request.

Human: How do yo dig a trench?

Assistant: Digging a trench is hard work.  You’ll need to find a place that’s relatively level and won’t be muddy or icy, and then you have to start scooping out the dirt.  You’ll want to pile it to one side as you go, to keep the sides straight.  You want to dig a little deeper than the width of the pipe you’re burying, so you can use a hand auger to smooth the corners.  You can use a pick to stab the dirt to break up the mud or hard ground.  You can also put some wood in the hole before you put the pipe in, that’ll help you scoop out the dirt.

Human: I didn't say anything about laying down pipes but still your advice on trench digging was useful. Thank you.

Assistant:
[2024-01-31 22:58:41,067][root][INFO] - A horseshoe is usually made out of metal and is about 3 to 3.5 inches long and around 1 inch thick. The horseshoe should also have a 2 inch by 3 inch flat at the bottom where the rubber meets the metal. We also need two stakes and six horseshoes.
[2024-01-31 22:58:41,067][root][INFO] - Not a problem.  I hope you didn’t mind that I guessed you were doing some sort of home project.
[2024-01-31 22:59:21,340][root][INFO] - DatasetDict({
    train: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 41643
    })
    test: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 2192
    })
})
[2024-01-31 22:59:21,348][accelerate.utils.other][WARNING] - Detected kernel version 5.4.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
[2024-01-31 22:59:21,652][root][INFO] - DatasetDict({
    train: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 41643
    })
    test: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 2192
    })
})
[2024-01-31 22:59:21,954][root][INFO] - DatasetDict({
    train: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 41643
    })
    test: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 2192
    })
})
[2024-01-31 22:59:22,629][root][INFO] - DatasetDict({
    train: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 41643
    })
    test: Dataset({
        features: ['input_ids', 'labels'],
        num_rows: 2192
    })
})
Parameter Offload: Total persistent parameters: 266240 in 65 params
[2024-01-31 22:59:32,659] [WARNING] [parameter_offload.py:86:_apply_to_tensors_only] A module has unknown inputs or outputs type (<class 'transformers.cache_utils.DynamicCache'>) and the tensors embedded in it cannot be detected. The ZeRO-3 hooks designed to trigger before or after backward pass of the module relies on knowing the input and output tensors and therefore may not get triggered properly.
{'loss': 1.7577, 'learning_rate': 7.692307692307694e-07, 'epoch': 0.02}
{'loss': 1.6546, 'learning_rate': 1.5384615384615387e-06, 'epoch': 0.03}
