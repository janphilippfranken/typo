/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/trl/trainer/ppo_config.py:141: UserWarning: The `optimize_cuda_cache` arguement will be deprecated soon, please use `optimize_device_cache` instead.
  warnings.warn(
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'train_16bit': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/experiments/hh_rlhf/train/wandb/run-20240126_123400-3svvf43i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cai_data_hh_rlhf_synthetic_16bit_rank_4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai/runs/3svvf43i
Loading checkpoint shards:   0%|          | 0/19 [00:00<?, ?it/s]Loading checkpoint shards:   5%|‚ñå         | 1/19 [00:01<00:19,  1.08s/it]Loading checkpoint shards:  11%|‚ñà         | 2/19 [00:02<00:16,  1.01it/s]Loading checkpoint shards:  16%|‚ñà‚ñå        | 3/19 [00:02<00:14,  1.10it/s]Loading checkpoint shards:  21%|‚ñà‚ñà        | 4/19 [00:03<00:12,  1.16it/s]Loading checkpoint shards:  26%|‚ñà‚ñà‚ñã       | 5/19 [00:04<00:11,  1.19it/s]Loading checkpoint shards:  32%|‚ñà‚ñà‚ñà‚ñè      | 6/19 [00:05<00:10,  1.25it/s]Loading checkpoint shards:  37%|‚ñà‚ñà‚ñà‚ñã      | 7/19 [00:05<00:09,  1.29it/s]Loading checkpoint shards:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 8/19 [00:06<00:08,  1.35it/s]Loading checkpoint shards:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 9/19 [00:07<00:07,  1.37it/s]Loading checkpoint shards:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 10/19 [00:07<00:06,  1.44it/s]Loading checkpoint shards:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 11/19 [00:08<00:05,  1.42it/s]Loading checkpoint shards:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 12/19 [00:09<00:04,  1.45it/s]Loading checkpoint shards:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 13/19 [00:10<00:04,  1.32it/s]Loading checkpoint shards:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 14/19 [00:11<00:04,  1.20it/s]Loading checkpoint shards:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 15/19 [00:12<00:03,  1.14it/s]Loading checkpoint shards:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 16/19 [00:13<00:02,  1.07it/s]Loading checkpoint shards:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 17/19 [00:14<00:01,  1.06it/s]Loading checkpoint shards:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 18/19 [00:15<00:00,  1.06it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [00:15<00:00,  1.18it/s]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [00:15<00:00,  1.21it/s]
  0%|          | 0/2000 [00:00<?, ?it/s]Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/2000 [00:27<15:15:34, 27.48s/it]  0%|          | 2/2000 [00:55<15:20:39, 27.65s/it]                                                     0%|          | 2/2000 [00:55<15:20:39, 27.65s/it]  0%|          | 3/2000 [01:23<15:30:19, 27.95s/it]  0%|          | 4/2000 [01:49<15:05:55, 27.23s/it]                                                     0%|          | 4/2000 [01:49<15:05:55, 27.23s/it]  0%|          | 5/2000 [02:18<15:29:28, 27.95s/it]  0%|          | 6/2000 [02:47<15:32:58, 28.07s/it]                                                     0%|          | 6/2000 [02:47<15:32:58, 28.07s/it]  0%|          | 7/2000 [03:14<15:23:28, 27.80s/it]  0%|          | 8/2000 [03:41<15:11:07, 27.44s/it]                                                     0%|          | 8/2000 [03:41<15:11:07, 27.44s/it]  0%|          | 9/2000 [04:08<15:04:51, 27.27s/it]  0%|          | 10/2000 [04:36<15:13:29, 27.54s/it]                                                      0%|          | 10/2000 [04:36<15:13:29, 27.54s/it]  1%|          | 11/2000 [05:06<15:44:43, 28.50s/it]  1%|          | 12/2000 [05:30<14:53:16, 26.96s/it]                                                      1%|          | 12/2000 [05:30<14:53:16, 26.96s/it]  1%|          | 13/2000 [05:57<14:58:01, 27.12s/it]  1%|          | 14/2000 [06:25<15:04:25, 27.32s/it]                                                      1%|          | 14/2000 [06:25<15:04:25, 27.32s/it]  1%|          | 15/2000 [06:52<14:57:40, 27.13s/it]  1%|          | 16/2000 [07:19<14:57:31, 27.14s/it]                                                      1%|          | 16/2000 [07:19<14:57:31, 27.14s/it]  1%|          | 17/2000 [07:47<15:01:21, 27.27s/it]  1%|          | 18/2000 [08:14<15:00:56, 27.27s/it]                                                      1%|          | 18/2000 [08:14<15:00:56, 27.27s/it]  1%|          | 19/2000 [08:41<15:00:59, 27.29s/it]  1%|          | 20/2000 [09:07<14:47:06, 26.88s/it]                                                      1%|          | 20/2000 [09:07<14:47:06, 26.88s/it]  1%|          | 21/2000 [09:34<14:49:23, 26.96s/it]  1%|          | 22/2000 [10:06<15:41:00, 28.54s/it]                                                      1%|          | 22/2000 [10:06<15:41:00, 28.54s/it]  1%|          | 23/2000 [10:36<15:48:47, 28.79s/it]  1%|          | 24/2000 [11:02<15:27:32, 28.16s/it]                                                      1%|          | 24/2000 [11:02<15:27:32, 28.16s/it]  1%|‚ñè         | 25/2000 [11:30<15:23:01, 28.04s/it]  1%|‚ñè         | 26/2000 [11:58<15:15:11, 27.82s/it]                                                      1%|‚ñè         | 26/2000 [11:58<15:15:11, 27.82s/it]  1%|‚ñè         | 27/2000 [12:27<15:31:03, 28.31s/it]  1%|‚ñè         | 28/2000 [12:54<15:18:05, 27.93s/it]                                                      1%|‚ñè         | 28/2000 [12:54<15:18:05, 27.93s/it]  1%|‚ñè         | 29/2000 [13:21<15:07:12, 27.62s/it]  2%|‚ñè         | 30/2000 [13:48<15:00:52, 27.44s/it]                                                      2%|‚ñè         | 30/2000 [13:48<15:00:52, 27.44s/it]  2%|‚ñè         | 31/2000 [14:16<15:04:48, 27.57s/it]  2%|‚ñè         | 32/2000 [14:43<14:56:49, 27.34s/it]                                                      2%|‚ñè         | 32/2000 [14:43<14:56:49, 27.34s/it]  2%|‚ñè         | 33/2000 [15:13<15:23:52, 28.18s/it]  2%|‚ñè         | 34/2000 [15:44<15:54:36, 29.13s/it]                                                      2%|‚ñè         | 34/2000 [15:44<15:54:36, 29.13s/it]  2%|‚ñè         | 35/2000 [16:15<16:07:34, 29.54s/it]  2%|‚ñè         | 36/2000 [16:41<15:37:24, 28.64s/it]                                                      2%|‚ñè         | 36/2000 [16:41<15:37:24, 28.64s/it]  2%|‚ñè         | 37/2000 [17:10<15:37:48, 28.66s/it]  2%|‚ñè         | 38/2000 [17:36<15:16:19, 28.02s/it]                                                      2%|‚ñè         | 38/2000 [17:36<15:16:19, 28.02s/it]  2%|‚ñè         | 39/2000 [18:03<15:01:14, 27.58s/it]  2%|‚ñè         | 40/2000 [18:30<14:55:32, 27.41s/it]                                                      2%|‚ñè         | 40/2000 [18:30<14:55:32, 27.41s/it]  2%|‚ñè         | 41/2000 [18:58<15:04:15, 27.70s/it]  2%|‚ñè         | 42/2000 [19:25<14:55:20, 27.44s/it]                                                      2%|‚ñè         | 42/2000 [19:25<14:55:20, 27.44s/it]  2%|‚ñè         | 43/2000 [19:52<14:45:25, 27.15s/it]  2%|‚ñè         | 44/2000 [20:19<14:49:13, 27.28s/it]                                                      2%|‚ñè         | 44/2000 [20:19<14:49:13, 27.28s/it]  2%|‚ñè         | 45/2000 [20:45<14:31:38, 26.75s/it]  2%|‚ñè         | 46/2000 [21:15<15:03:47, 27.75s/it]                                                      2%|‚ñè         | 46/2000 [21:15<15:03:47, 27.75s/it]  2%|‚ñè         | 47/2000 [21:39<14:29:49, 26.72s/it]  2%|‚ñè         | 48/2000 [22:07<14:43:32, 27.16s/it]                                                      2%|‚ñè         | 48/2000 [22:07<14:43:32, 27.16s/it]  2%|‚ñè         | 49/2000 [22:34<14:36:57, 26.97s/it]  2%|‚ñé         | 50/2000 [22:59<14:23:20, 26.56s/it]                                                      2%|‚ñé         | 50/2000 [22:59<14:23:20, 26.56s/it]  3%|‚ñé         | 51/2000 [23:23<13:57:14, 25.77s/it]  3%|‚ñé         | 52/2000 [23:47<13:38:44, 25.22s/it]                                                      3%|‚ñé         | 52/2000 [23:47<13:38:44, 25.22s/it]  3%|‚ñé         | 53/2000 [24:13<13:40:04, 25.27s/it]  3%|‚ñé         | 54/2000 [24:39<13:51:25, 25.63s/it]                                                      3%|‚ñé         | 54/2000 [24:39<13:51:25, 25.63s/it]  3%|‚ñé         | 55/2000 [25:07<14:10:54, 26.25s/it]  3%|‚ñé         | 56/2000 [25:31<13:51:45, 25.67s/it]                                                      3%|‚ñé         | 56/2000 [25:31<13:51:45, 25.67s/it]  3%|‚ñé         | 57/2000 [26:00<14:18:54, 26.52s/it]  3%|‚ñé         | 58/2000 [26:29<14:42:42, 27.27s/it]                                                      3%|‚ñé         | 58/2000 [26:29<14:42:42, 27.27s/it]  3%|‚ñé         | 59/2000 [26:56<14:38:03, 27.14s/it]  3%|‚ñé         | 60/2000 [27:24<14:53:39, 27.64s/it]                                                      3%|‚ñé         | 60/2000 [27:24<14:53:39, 27.64s/it]  3%|‚ñé         | 61/2000 [27:51<14:40:41, 27.25s/it]  3%|‚ñé         | 62/2000 [28:20<15:02:43, 27.95s/it]                                                      3%|‚ñé         | 62/2000 [28:20<15:02:43, 27.95s/it]  3%|‚ñé         | 63/2000 [28:49<15:04:51, 28.03s/it]  3%|‚ñé         | 64/2000 [29:17<15:05:55, 28.08s/it]                                                      3%|‚ñé         | 64/2000 [29:17<15:05:55, 28.08s/it]  3%|‚ñé         | 65/2000 [29:44<14:57:44, 27.84s/it]  3%|‚ñé         | 66/2000 [30:14<15:19:07, 28.51s/it]                                                      3%|‚ñé         | 66/2000 [30:14<15:19:07, 28.51s/it]  3%|‚ñé         | 67/2000 [30:46<15:49:58, 29.49s/it]  3%|‚ñé         | 68/2000 [31:16<15:51:34, 29.55s/it]                                                      3%|‚ñé         | 68/2000 [31:16<15:51:34, 29.55s/it]  3%|‚ñé         | 69/2000 [31:44<15:37:57, 29.14s/it]  4%|‚ñé         | 70/2000 [32:10<15:14:20, 28.43s/it]                                                      4%|‚ñé         | 70/2000 [32:10<15:14:20, 28.43s/it]  4%|‚ñé         | 71/2000 [32:39<15:14:41, 28.45s/it]  4%|‚ñé         | 72/2000 [33:09<15:27:17, 28.86s/it]                                                      4%|‚ñé         | 72/2000 [33:09<15:27:17, 28.86s/it]  4%|‚ñé         | 73/2000 [33:38<15:26:33, 28.85s/it]  4%|‚ñé         | 74/2000 [34:08<15:36:08, 29.16s/it]                                                      4%|‚ñé         | 74/2000 [34:08<15:36:08, 29.16s/it]  4%|‚ñç         | 75/2000 [34:34<15:14:07, 28.49s/it]  4%|‚ñç         | 76/2000 [35:03<15:12:39, 28.46s/it]                                                      4%|‚ñç         | 76/2000 [35:03<15:12:39, 28.46s/it]  4%|‚ñç         | 77/2000 [35:28<14:38:27, 27.41s/it]  4%|‚ñç         | 78/2000 [35:54<14:24:10, 26.98s/it]                                                      4%|‚ñç         | 78/2000 [35:54<14:24:10, 26.98s/it]  4%|‚ñç         | 79/2000 [36:23<14:40:56, 27.51s/it]  4%|‚ñç         | 80/2000 [36:51<14:51:06, 27.85s/it]                                                      4%|‚ñç         | 80/2000 [36:51<14:51:06, 27.85s/it]  4%|‚ñç         | 81/2000 [37:18<14:39:48, 27.51s/it]  4%|‚ñç         | 82/2000 [37:46<14:43:06, 27.63s/it]                                                      4%|‚ñç         | 82/2000 [37:46<14:43:06, 27.63s/it]  4%|‚ñç         | 83/2000 [38:15<15:00:48, 28.19s/it]  4%|‚ñç         | 84/2000 [38:43<14:54:14, 28.00s/it]                                                      4%|‚ñç         | 84/2000 [38:43<14:54:14, 28.00s/it]  4%|‚ñç         | 85/2000 [39:10<14:47:32, 27.81s/it]  4%|‚ñç         | 86/2000 [39:38<14:47:46, 27.83s/it]                                                      4%|‚ñç         | 86/2000 [39:38<14:47:46, 27.83s/it]  4%|‚ñç         | 87/2000 [40:05<14:34:29, 27.43s/it]  4%|‚ñç         | 88/2000 [40:31<14:26:14, 27.18s/it]                                                      4%|‚ñç         | 88/2000 [40:31<14:26:14, 27.18s/it]  4%|‚ñç         | 89/2000 [41:00<14:43:41, 27.75s/it]  4%|‚ñç         | 90/2000 [41:31<15:15:02, 28.74s/it]                                                      4%|‚ñç         | 90/2000 [41:31<15:15:02, 28.74s/it]  5%|‚ñç         | 91/2000 [42:00<15:09:07, 28.57s/it]  5%|‚ñç         | 92/2000 [42:27<15:00:19, 28.31s/it]                                                      5%|‚ñç         | 92/2000 [42:27<15:00:19, 28.31s/it]  5%|‚ñç         | 93/2000 [42:55<14:51:44, 28.06s/it]  5%|‚ñç         | 94/2000 [43:21<14:30:46, 27.41s/it]                                                      5%|‚ñç         | 94/2000 [43:21<14:30:46, 27.41s/it]  5%|‚ñç         | 95/2000 [43:48<14:26:47, 27.30s/it]  5%|‚ñç         | 96/2000 [44:14<14:17:44, 27.03s/it]                                                      5%|‚ñç         | 96/2000 [44:14<14:17:44, 27.03s/it]  5%|‚ñç         | 97/2000 [44:43<14:36:55, 27.65s/it]  5%|‚ñç         | 98/2000 [45:13<15:02:06, 28.46s/it]                                                      5%|‚ñç         | 98/2000 [45:13<15:02:06, 28.46s/it]  5%|‚ñç         | 99/2000 [45:39<14:35:04, 27.62s/it]  5%|‚ñå         | 100/2000 [46:06<14:27:23, 27.39s/it]                                                       5%|‚ñå         | 100/2000 [46:06<14:27:23, 27.39s/it]
  0%|          | 0/507 [00:00<?, ?it/s][A
  0%|          | 2/507 [00:00<03:26,  2.44it/s][A
  1%|          | 3/507 [00:01<06:01,  1.40it/s][A
  1%|          | 4/507 [00:02<06:56,  1.21it/s][A