[2024-01-16 15:00:37,225] torch.distributed.run: [WARNING] 
[2024-01-16 15:00:37,225] torch.distributed.run: [WARNING] *****************************************
[2024-01-16 15:00:37,225] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-01-16 15:00:37,225] torch.distributed.run: [WARNING] *****************************************
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'train': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'train': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/experiments/hh_rlhf/train/wandb/run-20240116_150042-p2z6twzm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cai_data_hh_rlhf_combined
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai/runs/p2z6twzm
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/experiments/hh_rlhf/train/wandb/run-20240116_150042-1pvncgrk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cai_data_hh_rlhf_combined
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai/runs/1pvncgrk
Loading checkpoint shards:   0%|          | 0/19 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/19 [00:00<?, ?it/s]Loading checkpoint shards:   5%|‚ñå         | 1/19 [00:04<01:13,  4.06s/it]Loading checkpoint shards:   5%|‚ñå         | 1/19 [00:04<01:15,  4.22s/it]Loading checkpoint shards:  11%|‚ñà         | 2/19 [00:07<01:04,  3.81s/it]Loading checkpoint shards:  11%|‚ñà         | 2/19 [00:07<01:06,  3.92s/it]Loading checkpoint shards:  16%|‚ñà‚ñå        | 3/19 [00:11<00:59,  3.72s/it]Loading checkpoint shards:  16%|‚ñà‚ñå        | 3/19 [00:11<01:01,  3.85s/it]Loading checkpoint shards:  21%|‚ñà‚ñà        | 4/19 [00:14<00:54,  3.66s/it]Loading checkpoint shards:  21%|‚ñà‚ñà        | 4/19 [00:15<00:56,  3.76s/it]Loading checkpoint shards:  26%|‚ñà‚ñà‚ñã       | 5/19 [00:18<00:50,  3.63s/it]Loading checkpoint shards:  26%|‚ñà‚ñà‚ñã       | 5/19 [00:19<00:52,  3.75s/it]Loading checkpoint shards:  32%|‚ñà‚ñà‚ñà‚ñè      | 6/19 [00:22<00:47,  3.65s/it]Loading checkpoint shards:  32%|‚ñà‚ñà‚ñà‚ñè      | 6/19 [00:22<00:48,  3.74s/it]Loading checkpoint shards:  37%|‚ñà‚ñà‚ñà‚ñã      | 7/19 [00:25<00:43,  3.63s/it]Loading checkpoint shards:  37%|‚ñà‚ñà‚ñà‚ñã      | 7/19 [00:26<00:44,  3.75s/it]Loading checkpoint shards:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 8/19 [00:29<00:40,  3.64s/it]Loading checkpoint shards:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 8/19 [00:30<00:41,  3.76s/it]Loading checkpoint shards:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 9/19 [00:32<00:36,  3.63s/it]Loading checkpoint shards:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 9/19 [00:33<00:37,  3.73s/it]Loading checkpoint shards:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 10/19 [00:36<00:32,  3.57s/it]Loading checkpoint shards:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 10/19 [00:37<00:33,  3.68s/it]Loading checkpoint shards:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 11/19 [00:40<00:28,  3.59s/it]Loading checkpoint shards:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 11/19 [00:41<00:29,  3.66s/it]Loading checkpoint shards:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 12/19 [00:43<00:25,  3.58s/it]Loading checkpoint shards:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 12/19 [00:44<00:25,  3.65s/it]Loading checkpoint shards:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 13/19 [00:47<00:21,  3.56s/it]Loading checkpoint shards:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 13/19 [00:48<00:21,  3.61s/it]Loading checkpoint shards:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 14/19 [00:50<00:17,  3.52s/it]Loading checkpoint shards:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 14/19 [00:51<00:17,  3.56s/it]Loading checkpoint shards:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 15/19 [00:54<00:14,  3.53s/it]Loading checkpoint shards:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 15/19 [00:55<00:14,  3.58s/it]Loading checkpoint shards:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 16/19 [00:57<00:10,  3.52s/it]Loading checkpoint shards:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 16/19 [00:58<00:10,  3.57s/it]Loading checkpoint shards:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 17/19 [01:01<00:07,  3.51s/it]Loading checkpoint shards:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 17/19 [01:02<00:07,  3.55s/it]Loading checkpoint shards:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 18/19 [01:04<00:03,  3.46s/it]Loading checkpoint shards:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 18/19 [01:05<00:03,  3.48s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:07<00:00,  3.29s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:07<00:00,  3.54s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:08<00:00,  3.26s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:08<00:00,  3.61s/it]
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|          | 0/2000 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1652: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1652: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
  0%|          | 1/2000 [00:24<13:30:05, 24.32s/it]  0%|          | 2/2000 [00:48<13:25:50, 24.20s/it]                                                     0%|          | 2/2000 [00:48<13:25:50, 24.20s/it]  0%|          | 3/2000 [01:13<13:34:52, 24.48s/it]  0%|          | 4/2000 [01:37<13:37:46, 24.58s/it]                                                     0%|          | 4/2000 [01:37<13:37:46, 24.58s/it]  0%|          | 5/2000 [02:01<13:24:09, 24.19s/it]  0%|          | 6/2000 [02:28<13:52:42, 25.06s/it]                                                     0%|          | 6/2000 [02:28<13:52:42, 25.06s/it]  0%|          | 7/2000 [02:53<13:50:00, 24.99s/it]  0%|          | 8/2000 [03:15<13:27:14, 24.31s/it]                                                     0%|          | 8/2000 [03:15<13:27:14, 24.31s/it]  0%|          | 9/2000 [03:40<13:31:54, 24.47s/it]  0%|          | 10/2000 [04:04<13:21:25, 24.16s/it]                                                      0%|          | 10/2000 [04:04<13:21:25, 24.16s/it]
  0%|          | 0/62 [00:00<?, ?it/s][A
  3%|‚ñé         | 2/62 [00:00<00:26,  2.29it/s][A
  5%|‚ñç         | 3/62 [00:02<00:43,  1.34it/s][A
  6%|‚ñã         | 4/62 [00:02<00:46,  1.25it/s][A
  8%|‚ñä         | 5/62 [00:04<00:52,  1.09it/s][A
 10%|‚ñâ         | 6/62 [00:05<00:53,  1.04it/s][A
 11%|‚ñà‚ñè        | 7/62 [00:05<00:50,  1.10it/s][A
 13%|‚ñà‚ñé        | 8/62 [00:07<00:52,  1.03it/s][A
 15%|‚ñà‚ñç        | 9/62 [00:08<00:53,  1.01s/it][A
 16%|‚ñà‚ñå        | 10/62 [00:08<00:49,  1.06it/s][A
 18%|‚ñà‚ñä        | 11/62 [00:09<00:48,  1.04it/s][A
 19%|‚ñà‚ñâ        | 12/62 [00:11<00:52,  1.05s/it][A
 21%|‚ñà‚ñà        | 13/62 [00:11<00:47,  1.03it/s][A
 23%|‚ñà‚ñà‚ñé       | 14/62 [00:13<00:55,  1.15s/it][A
 24%|‚ñà‚ñà‚ñç       | 15/62 [00:14<00:49,  1.05s/it][A
 26%|‚ñà‚ñà‚ñå       | 16/62 [00:15<00:49,  1.07s/it][A
 27%|‚ñà‚ñà‚ñã       | 17/62 [00:16<00:44,  1.01it/s][A
 29%|‚ñà‚ñà‚ñâ       | 18/62 [00:17<00:45,  1.04s/it][A
 31%|‚ñà‚ñà‚ñà       | 19/62 [00:18<00:49,  1.15s/it][A
 32%|‚ñà‚ñà‚ñà‚ñè      | 20/62 [00:19<00:44,  1.07s/it][A
 34%|‚ñà‚ñà‚ñà‚ñç      | 21/62 [00:20<00:42,  1.03s/it][A
 35%|‚ñà‚ñà‚ñà‚ñå      | 22/62 [00:21<00:41,  1.05s/it][A
 37%|‚ñà‚ñà‚ñà‚ñã      | 23/62 [00:22<00:39,  1.00s/it][A
 39%|‚ñà‚ñà‚ñà‚ñä      | 24/62 [00:23<00:35,  1.07it/s][A
 40%|‚ñà‚ñà‚ñà‚ñà      | 25/62 [00:24<00:33,  1.10it/s][A
 42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 26/62 [00:25<00:38,  1.06s/it][A
 44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 27/62 [00:26<00:38,  1.09s/it][A
 45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 28/62 [00:27<00:34,  1.02s/it][A
 47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 29/62 [00:28<00:33,  1.03s/it][A
 48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 30/62 [00:29<00:34,  1.07s/it][A
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 31/62 [00:30<00:31,  1.03s/it][A
 52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 32/62 [00:32<00:32,  1.08s/it][A
 53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 33/62 [00:32<00:29,  1.03s/it][A
 55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 34/62 [00:34<00:28,  1.03s/it][A
 56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 35/62 [00:35<00:31,  1.16s/it][A
 58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 36/62 [00:36<00:27,  1.07s/it][A
 60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 37/62 [00:37<00:24,  1.03it/s][A
 61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 38/62 [00:38<00:23,  1.02it/s][A
 63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 39/62 [00:38<00:21,  1.07it/s][A
 65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 40/62 [00:40<00:23,  1.06s/it][A
 66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 41/62 [00:41<00:21,  1.00s/it][A
 68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 42/62 [00:41<00:19,  1.03it/s][A
 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 43/62 [00:42<00:17,  1.10it/s][A
 71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 44/62 [00:43<00:16,  1.12it/s][A
 73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 45/62 [00:44<00:15,  1.12it/s][A
 74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 46/62 [00:45<00:15,  1.03it/s][A
 76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 47/62 [00:46<00:14,  1.02it/s][A
 77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 48/62 [00:47<00:14,  1.00s/it][A
 79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 49/62 [00:48<00:12,  1.03it/s][A
 81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 50/62 [00:49<00:11,  1.04it/s][A
 82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 51/62 [00:50<00:10,  1.07it/s][A
 84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 52/62 [00:51<00:09,  1.08it/s][A
 85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 53/62 [00:52<00:08,  1.12it/s][A
 87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 54/62 [00:53<00:07,  1.03it/s][A
 89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 55/62 [00:54<00:06,  1.03it/s][A
 90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 56/62 [00:55<00:05,  1.02it/s][A
 92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 57/62 [00:56<00:05,  1.04s/it][A
 94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 58/62 [00:57<00:03,  1.02it/s][A
 95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 59/62 [00:57<00:02,  1.11it/s][A
 97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 60/62 [00:59<00:02,  1.01s/it][A
 98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 61/62 [01:00<00:00,  1.02it/s][A
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 62/62 [01:01<00:00,  1.05it/s][A                                                    
                                               [A  0%|          | 10/2000 [05:06<13:21:25, 24.16s/it]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 62/62 [01:01<00:00,  1.05it/s][A
                                               [A  1%|          | 11/2000 [05:29<23:43:12, 42.93s/it]  1%|          | 12/2000 [05:52<20:23:47, 36.94s/it]                                                      1%|          | 12/2000 [05:52<20:23:47, 36.94s/it]  1%|          | 13/2000 [06:16<18:08:53, 32.88s/it]  1%|          | 14/2000 [06:41<16:46:19, 30.40s/it]                                                      1%|          | 14/2000 [06:41<16:46:19, 30.40s/it]  1%|          | 15/2000 [07:05<15:48:57, 28.68s/it]  1%|          | 16/2000 [07:29<14:57:03, 27.13s/it]                                                      1%|          | 16/2000 [07:29<14:57:03, 27.13s/it]  1%|          | 17/2000 [07:54<14:32:43, 26.41s/it]  1%|          | 18/2000 [08:19<14:18:01, 25.97s/it]                                                      1%|          | 18/2000 [08:19<14:18:01, 25.97s/it]