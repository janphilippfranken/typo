[2024-01-16 14:14:28,097] torch.distributed.run: [WARNING] 
[2024-01-16 14:14:28,097] torch.distributed.run: [WARNING] *****************************************
[2024-01-16 14:14:28,097] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-01-16 14:14:28,097] torch.distributed.run: [WARNING] *****************************************
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'train': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'train': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/experiments/hh_rlhf/train/wandb/run-20240116_141432-pb0lear3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cai_data_hh_rlhf_flipped
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai/runs/pb0lear3
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/experiments/hh_rlhf/train/wandb/run-20240116_141432-ej7qupvf
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cai_data_hh_rlhf_flipped
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai/runs/ej7qupvf
Loading checkpoint shards:   0%|          | 0/19 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/19 [00:00<?, ?it/s]Loading checkpoint shards:   5%|‚ñå         | 1/19 [00:03<01:09,  3.87s/it]Loading checkpoint shards:   5%|‚ñå         | 1/19 [00:03<01:11,  3.98s/it]Loading checkpoint shards:  11%|‚ñà         | 2/19 [00:07<01:00,  3.56s/it]Loading checkpoint shards:  11%|‚ñà         | 2/19 [00:07<01:01,  3.61s/it]Loading checkpoint shards:  16%|‚ñà‚ñå        | 3/19 [00:10<00:55,  3.45s/it]Loading checkpoint shards:  16%|‚ñà‚ñå        | 3/19 [00:10<00:56,  3.53s/it]Loading checkpoint shards:  21%|‚ñà‚ñà        | 4/19 [00:13<00:51,  3.42s/it]Loading checkpoint shards:  21%|‚ñà‚ñà        | 4/19 [00:14<00:52,  3.49s/it]Loading checkpoint shards:  26%|‚ñà‚ñà‚ñã       | 5/19 [00:17<00:47,  3.39s/it]Loading checkpoint shards:  26%|‚ñà‚ñà‚ñã       | 5/19 [00:17<00:48,  3.46s/it]Loading checkpoint shards:  32%|‚ñà‚ñà‚ñà‚ñè      | 6/19 [00:20<00:44,  3.41s/it]Loading checkpoint shards:  32%|‚ñà‚ñà‚ñà‚ñè      | 6/19 [00:21<00:45,  3.46s/it]Loading checkpoint shards:  37%|‚ñà‚ñà‚ñà‚ñã      | 7/19 [00:23<00:40,  3.37s/it]Loading checkpoint shards:  37%|‚ñà‚ñà‚ñà‚ñã      | 7/19 [00:24<00:41,  3.44s/it]Loading checkpoint shards:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 8/19 [00:27<00:36,  3.35s/it]Loading checkpoint shards:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 8/19 [00:27<00:37,  3.43s/it]Loading checkpoint shards:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 9/19 [00:30<00:33,  3.33s/it]Loading checkpoint shards:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 9/19 [00:31<00:34,  3.42s/it]Loading checkpoint shards:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 10/19 [00:33<00:29,  3.31s/it]Loading checkpoint shards:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 10/19 [00:34<00:30,  3.38s/it]Loading checkpoint shards:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 11/19 [00:37<00:26,  3.27s/it]Loading checkpoint shards:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 11/19 [00:37<00:26,  3.34s/it]Loading checkpoint shards:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 12/19 [00:40<00:22,  3.25s/it]Loading checkpoint shards:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 12/19 [00:41<00:23,  3.35s/it]Loading checkpoint shards:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 13/19 [00:43<00:19,  3.22s/it]Loading checkpoint shards:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 13/19 [00:44<00:19,  3.31s/it]Loading checkpoint shards:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 14/19 [00:46<00:16,  3.21s/it]Loading checkpoint shards:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 14/19 [00:47<00:16,  3.27s/it]Loading checkpoint shards:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 15/19 [00:49<00:13,  3.25s/it]Loading checkpoint shards:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 15/19 [00:50<00:13,  3.31s/it]Loading checkpoint shards:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 16/19 [00:53<00:09,  3.24s/it]Loading checkpoint shards:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 16/19 [00:54<00:09,  3.29s/it]Loading checkpoint shards:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 17/19 [00:56<00:06,  3.21s/it]Loading checkpoint shards:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 17/19 [00:57<00:06,  3.26s/it]Loading checkpoint shards:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 18/19 [00:59<00:03,  3.22s/it]Loading checkpoint shards:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 18/19 [01:00<00:03,  3.24s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:02<00:00,  3.09s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:02<00:00,  3.28s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:03<00:00,  3.26s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 19/19 [01:03<00:00,  3.36s/it]
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  0%|          | 0/2500 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1652: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1652: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
  0%|          | 1/2500 [00:26<18:21:59, 26.46s/it]  0%|          | 2/2500 [00:53<18:29:15, 26.64s/it]                                                     0%|          | 2/2500 [00:53<18:29:15, 26.64s/it]  0%|          | 3/2500 [01:18<17:58:49, 25.92s/it]  0%|          | 4/2500 [01:43<17:43:36, 25.57s/it]                                                     0%|          | 4/2500 [01:43<17:43:36, 25.57s/it]  0%|          | 5/2500 [02:09<17:55:13, 25.86s/it]  0%|          | 6/2500 [02:34<17:36:53, 25.43s/it]                                                     0%|          | 6/2500 [02:34<17:36:53, 25.43s/it]  0%|          | 7/2500 [02:58<17:20:43, 25.05s/it]  0%|          | 8/2500 [03:23<17:20:46, 25.06s/it]                                                     0%|          | 8/2500 [03:23<17:20:46, 25.06s/it]  0%|          | 9/2500 [03:50<17:42:37, 25.60s/it]  0%|          | 10/2500 [04:16<17:49:46, 25.78s/it]                                                      0%|          | 10/2500 [04:16<17:49:46, 25.78s/it]  0%|          | 11/2500 [04:40<17:31:04, 25.34s/it]  0%|          | 12/2500 [05:05<17:17:32, 25.02s/it]                                                      0%|          | 12/2500 [05:05<17:17:32, 25.02s/it]  1%|          | 13/2500 [05:31<17:38:07, 25.53s/it]  1%|          | 14/2500 [05:55<17:16:47, 25.02s/it]                                                      1%|          | 14/2500 [05:55<17:16:47, 25.02s/it]  1%|          | 15/2500 [06:19<16:57:29, 24.57s/it]  1%|          | 16/2500 [06:42<16:42:40, 24.22s/it]                                                      1%|          | 16/2500 [06:42<16:42:40, 24.22s/it]  1%|          | 17/2500 [07:08<17:02:10, 24.70s/it]  1%|          | 18/2500 [07:32<16:51:46, 24.46s/it]                                                      1%|          | 18/2500 [07:32<16:51:46, 24.46s/it]  1%|          | 19/2500 [07:57<16:56:52, 24.59s/it]wandb: ERROR Dropped streaming file chunk (see wandb/debug-internal.log)
  1%|          | 20/2500 [08:21<16:45:55, 24.34s/it]                                                      1%|          | 20/2500 [08:21<16:45:55, 24.34s/it]wandb: ERROR Dropped streaming file chunk (see wandb/debug-internal.log)
  1%|          | 21/2500 [08:46<16:54:09, 24.55s/it]wandb: ERROR Dropped streaming file chunk (see wandb/debug-internal.log)
  1%|          | 22/2500 [09:09<16:38:30, 24.18s/it]                                                      1%|          | 22/2500 [09:09<16:38:30, 24.18s/it]