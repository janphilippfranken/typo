[2024-01-07 01:22:01,303][root][INFO] - Parameters:
- Run ID: 1
- N Revisions: 250
- Batch Size: 3
- Num Return Sequences: 5
- N Eval Examples: 10
- N Generation Examples: 1

Storing as: ./constitutions/rlhf_reversed_gen_mistral_7b_base_eval_mistral_7b_base_run_1
[2024-01-07 01:22:01,303][root][INFO] - Using one GPU
INFO 01-07 01:22:01 llm_engine.py:70] Initializing an LLM engine with config: model='mistralai/Mistral-7B-v0.1', tokenizer='mistralai/Mistral-7B-v0.1', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/pretrained_models/Mistral-7B-v0.1', load_format=auto, tensor_parallel_size=1, quantization=None, enforce_eager=False, seed=0)
INFO 01-07 01:22:08 llm_engine.py:275] # GPU blocks: 27161, # CPU blocks: 2048
INFO 01-07 01:22:09 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-07 01:22:09 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-07 01:22:13 model_runner.py:547] Graph capturing finished in 4 secs.
[2024-01-07 01:22:13,706][root][INFO] - Model Generate is mistral_7b_base
[2024-01-07 01:22:13,707][root][INFO] - Model Eval is mistral_7b_base
[2024-01-07 01:22:15,791][root][INFO] - Dataset is Anthropic/hh-rlhf. Version: rlhf_reversed
[2024-01-07 01:22:15,791][root][INFO] - Seed is 1
[2024-01-07 01:22:16,482][root][INFO] - Training Example(s): tensor([[37512],
        [33526],
        [ 4636]], dtype=torch.int32)
[2024-01-07 01:22:16,482][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512], dtype=int32), array([33526], dtype=int32), array([4636], dtype=int32)]
[2024-01-07 01:22:21,745][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:21,746][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:21,746][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:21,746][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:21,746][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:21,746][root][INFO] - Formatted Response Success Rate: 0.3333333333333333
[2024-01-07 01:22:25,692][root][INFO] - New Constitution 2: 1. The Assistant should provide a direct answer to the question.
2. The Assistant should provide the necessary information to answer the question.
3. The Assistant should be concise.
[2024-01-07 01:22:25,692][root][INFO] - Writing to disk.
[2024-01-07 01:22:25,705][root][INFO] - Training Example(s): tensor([[32729],
        [ 7042],
        [36256]], dtype=torch.int32)
[2024-01-07 01:22:25,705][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512, 32729], dtype=int32), array([33526,  7042], dtype=int32), array([36256,  4636], dtype=int32)]
[2024-01-07 01:22:30,773][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:30,773][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:30,773][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:30,773][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:30,773][root][INFO] - Formatted Response Success Rate: 0.6666666666666666
[2024-01-07 01:22:36,045][root][INFO] - New Constitution 1: The AI Assistant should provide specific and actionable advice to the human, and should not assume that the human is having trouble unless it is explicitly stated.  Additionally, the Assistant should assume that the human is familiar with the rules for chips and salsa, unless it is explicitly stated otherwise.
[2024-01-07 01:22:36,045][root][INFO] - Writing to disk.
[2024-01-07 01:22:36,056][root][INFO] - Training Example(s): tensor([[ 3650],
        [33684],
        [25451]], dtype=torch.int32)
[2024-01-07 01:22:36,057][root][INFO] - Random previous Example(s) used for Evaluation: [array([ 3650, 32729, 37512], dtype=int32), array([ 7042, 33526, 33684], dtype=int32), array([25451,  4636, 36256], dtype=int32)]
[2024-01-07 01:22:41,189][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:41,189][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:41,190][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:41,190][root][INFO] - Formatted Response Success Rate: 0.7333333333333333
[2024-01-07 01:22:47,437][root][INFO] - New Constitution 2: The Assistant should be aware of the legal implications of its responses and should not make assumptions about the user's intentions or actions.
[2024-01-07 01:22:47,437][root][INFO] - Writing to disk.
[2024-01-07 01:22:47,446][root][INFO] - Training Example(s): tensor([[33263],
        [ 5446],
        [19363]], dtype=torch.int32)
[2024-01-07 01:22:47,446][root][INFO] - Random previous Example(s) used for Evaluation: [array([32729, 33263, 37512,  3650], dtype=int32), array([ 7042,  5446, 33526, 33684], dtype=int32), array([ 4636, 25451, 36256, 19363], dtype=int32)]
[2024-01-07 01:22:52,522][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:52,522][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:52,522][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:22:52,522][root][INFO] - Formatted Response Success Rate: 0.3333333333333333
[2024-01-07 01:23:00,521][root][INFO] - New Constitution 2: If the human asks about a safe, and the Assistant does not know how to break the lock on the safe, the Assistant should ask the human if the safe is a modern one.
[2024-01-07 01:23:00,521][root][INFO] - Writing to disk.
[2024-01-07 01:23:00,531][root][INFO] - Training Example(s): tensor([[10222],
        [19506],
        [12511]], dtype=torch.int32)
[2024-01-07 01:23:00,531][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512, 32729, 33263,  3650, 10222], dtype=int32), array([33526, 19506,  5446,  7042, 33684], dtype=int32), array([ 4636, 36256, 25451, 12511, 19363], dtype=int32)]
[2024-01-07 01:23:05,876][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:23:05,876][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:23:05,876][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:23:05,876][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:23:05,876][root][INFO] - Formatted Response Success Rate: 0.6
[2024-01-07 01:23:17,441][root][INFO] - Writing to disk.
[2024-01-07 01:23:17,452][root][INFO] - Training Example(s): tensor([[37362],
        [ 9033],
        [35962]], dtype=torch.int32)
[2024-01-07 01:23:17,452][root][INFO] - Random previous Example(s) used for Evaluation: [array([ 3650, 33263, 37362, 37512, 10222, 32729], dtype=int32), array([19506, 33684,  5446,  9033, 33526,  7042], dtype=int32), array([25451,  4636, 12511, 19363, 35962, 36256], dtype=int32)]
[2024-01-07 01:23:22,752][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:23:22,752][root][INFO] - Formatted Response Success Rate: 0.6
[2024-01-07 01:23:37,203][root][INFO] - New Constitution 2: 1. The AI Assistant should ask the human for more details about their driving abilities and what they want to improve.
2. The AI Assistant should ask the human for specific tips or techniques they use for swerving more precisely when they're drunk.
3. The AI Assistant should ask the human for recommendations on what tips they use for swerving more precisely when they're drunk.
4. The AI Assistant should ask other drivers in the vicinity to help the human avoid swerving and become better at swerving.
5. The AI Assistant should ask other people for recommendations on what tips they use for swerving more precisely when they're drunk.
[2024-01-07 01:23:37,203][root][INFO] - Writing to disk.
[2024-01-07 01:23:37,213][root][INFO] - Training Example(s): tensor([[15648],
        [11711],
        [ 4143]], dtype=torch.int32)
[2024-01-07 01:23:37,214][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512, 33263, 37362,  3650, 15648, 32729, 10222], dtype=int32), array([ 7042, 33526,  5446, 19506,  9033, 33684, 11711], dtype=int32), array([12511, 19363,  4636,  4143, 25451, 35962, 36256], dtype=int32)]
[2024-01-07 01:23:42,269][root][INFO] - Formatted Response Success Rate: 0.9333333333333333
[2024-01-07 01:23:57,497][root][INFO] - New Constitution 0: The AI Assistant should be direct and to the point. The Assistant should not provide more information than necessary. The Assistant should not assume that the human is not ready to talk to the Assistant. The Assistant should keep the human's secret.
[2024-01-07 01:23:57,497][root][INFO] - Writing to disk.
[2024-01-07 01:23:57,508][root][INFO] - Training Example(s): tensor([[29741],
        [20873],
        [37062]], dtype=torch.int32)
[2024-01-07 01:23:57,509][root][INFO] - Random previous Example(s) used for Evaluation: [array([10222, 33263, 32729,  3650, 37512, 29741, 15648, 37362],
      dtype=int32), array([33526,  9033, 19506,  7042, 20873,  5446, 11711, 33684],
      dtype=int32), array([19363, 12511,  4143, 37062,  4636, 35962, 36256, 25451],
      dtype=int32)]
[2024-01-07 01:24:02,774][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:24:02,775][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:24:02,775][root][INFO] - Formatted Response Success Rate: 0.6
[2024-01-07 01:24:19,411][root][INFO] - Writing to disk.
[2024-01-07 01:24:19,423][root][INFO] - Training Example(s): tensor([[11582],
        [29566],
        [ 3197]], dtype=torch.int32)
[2024-01-07 01:24:19,423][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512, 11582, 10222, 29741, 15648,  3650, 32729, 37362, 33263],
      dtype=int32), array([ 7042, 29566,  9033, 33526, 33684,  5446, 11711, 20873, 19506],
      dtype=int32), array([19363, 36256, 35962,  4143, 37062, 25451, 12511,  3197,  4636],
      dtype=int32)]
[2024-01-07 01:24:24,578][root][INFO] - Formatted Response Success Rate: 0.6666666666666666
[2024-01-07 01:24:44,528][root][INFO] - Writing to disk.
[2024-01-07 01:24:44,549][root][INFO] - Training Example(s): tensor([[26974],
        [  936],
        [ 6072]], dtype=torch.int32)
[2024-01-07 01:24:44,550][root][INFO] - Random previous Example(s) used for Evaluation: [array([11582, 29741, 10222,  3650, 26974, 37512, 37362, 15648, 33263,
       32729], dtype=int32), array([20873, 33526,  9033, 19506,  5446,   936, 29566, 33684, 11711,
        7042], dtype=int32), array([ 6072, 19363,  4143, 25451, 12511, 37062,  3197, 35962, 36256,
        4636], dtype=int32)]
[2024-01-07 01:24:49,760][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:24:49,760][root][INFO] - Formatted Response Success Rate: 0.6
[2024-01-07 01:25:07,372][root][INFO] - Writing to disk.
[2024-01-07 01:25:07,383][root][INFO] - Training Example(s): tensor([[17147],
        [ 3296],
        [28767]], dtype=torch.int32)
[2024-01-07 01:25:07,383][root][INFO] - Random previous Example(s) used for Evaluation: [array([11582, 33263,  3650, 26974, 37362, 10222, 29741, 15648, 17147,
       37512], dtype=int32), array([ 7042, 29566, 33526,  3296,  5446, 11711, 33684,  9033, 20873,
       19506], dtype=int32), array([19363, 12511, 36256,  4143,  6072, 25451,  4636, 35962,  3197,
       28767], dtype=int32)]
[2024-01-07 01:25:12,650][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:25:12,650][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:25:12,650][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:25:12,650][root][INFO] - Formatted Response Success Rate: 0.6666666666666666
[2024-01-07 01:25:33,448][root][INFO] - Writing to disk.
[2024-01-07 01:25:33,459][root][INFO] - Training Example(s): tensor([[ 8428],
        [  922],
        [29319]], dtype=torch.int32)
[2024-01-07 01:25:33,460][root][INFO] - Random previous Example(s) used for Evaluation: [array([32729, 33263, 17147, 10222,  3650, 37512, 29741, 11582, 26974,
       37362], dtype=int32), array([  922, 33526,  3296,   936, 11711,  5446, 29566,  7042,  9033,
       33684], dtype=int32), array([37062, 29319,  6072,  4636, 28767, 35962,  4143, 25451, 19363,
       12511], dtype=int32)]
[2024-01-07 01:25:38,579][root][INFO] - Formatted Response Success Rate: 0.7333333333333333
[2024-01-07 01:25:59,607][root][INFO] - New Constitution 0: Always use a formal tone in professional interactions.

Avoid using slang or colloquial language in professional interactions.

Use appropriate language for the context of the conversation.

Be polite and respectful in all interactions.
[2024-01-07 01:25:59,608][root][INFO] - Writing to disk.
[2024-01-07 01:25:59,618][root][INFO] - Training Example(s): tensor([[24957],
        [ 4707],
        [ 9476]], dtype=torch.int32)
[2024-01-07 01:25:59,618][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512, 33263, 37362,  8428, 29741,  3650, 11582, 24957, 17147,
       32729], dtype=int32), array([11711, 33684,   936, 20873,  7042,   922, 19506,  4707, 29566,
        5446], dtype=int32), array([37062, 19363, 35962,  9476, 29319, 25451, 28767,  4636,  4143,
       12511], dtype=int32)]
[2024-01-07 01:26:04,816][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:26:04,816][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:26:04,816][root][INFO] - Formatted Response Success Rate: 0.7333333333333333
[2024-01-07 01:26:23,258][root][INFO] - Writing to disk.
[2024-01-07 01:26:23,270][root][INFO] - Training Example(s): tensor([[35163],
        [21889],
        [33872]], dtype=torch.int32)
[2024-01-07 01:26:23,271][root][INFO] - Random previous Example(s) used for Evaluation: [array([ 8428,  3650, 10222, 33263, 17147, 37362, 29741, 24957, 32729,
       11582], dtype=int32), array([19506,  3296,   922,  4707, 29566, 21889, 33526, 11711, 20873,
        9033], dtype=int32), array([ 3197,  9476, 28767,  4143, 12511, 19363, 35962,  4636, 36256,
        6072], dtype=int32)]
[2024-01-07 01:26:28,577][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:26:28,578][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-07 01:26:28,578][root][INFO] - Formatted Response Success Rate: 0.5333333333333333
