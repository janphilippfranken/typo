[2024-01-06 23:44:35,799][root][INFO] - Parameters:
- Run ID: vllm_1
- N Revisions: 500
- Batch Size: 10
- Num Return Sequences: 10
- N Eval Examples: 15
- N Generation Examples: 1

Storing as: ./constitutions/rlhf_gen_mistral_7b_base_eval_mistral_7b_base_run_vllm_1
[2024-01-06 23:44:35,799][root][INFO] - Using one GPU
INFO 01-06 23:44:36 llm_engine.py:70] Initializing an LLM engine with config: model='mistralai/Mistral-7B-v0.1', tokenizer='mistralai/Mistral-7B-v0.1', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/pretrained_models/Mistral-7B-v0.1', load_format=auto, tensor_parallel_size=1, quantization=None, enforce_eager=False, seed=0)
INFO 01-06 23:44:43 llm_engine.py:275] # GPU blocks: 27161, # CPU blocks: 2048
INFO 01-06 23:44:44 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-06 23:44:44 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-06 23:44:48 model_runner.py:547] Graph capturing finished in 4 secs.
[2024-01-06 23:44:48,051][root][INFO] - Model Generate is mistral_7b_base
[2024-01-06 23:44:48,052][root][INFO] - Model Eval is mistral_7b_base
[2024-01-06 23:44:50,351][root][INFO] - Dataset is Anthropic/hh-rlhf. Version: rlhf
[2024-01-06 23:44:50,352][root][INFO] - Seed is 1
[2024-01-06 23:44:54,681][root][INFO] - Training Example(s): tensor([[37512],
        [ 4636],
        [10224],
        [21252],
        [20976],
        [27538],
        [19280],
        [27916],
        [20164],
        [16147]], dtype=torch.int32)
[2024-01-06 23:44:54,682][root][INFO] - Random previous Example(s) used for Evaluation: [array([37512], dtype=int32), array([4636], dtype=int32), array([10224], dtype=int32), array([21252], dtype=int32), array([20976], dtype=int32), array([27538], dtype=int32), array([19280], dtype=int32), array([27916], dtype=int32), array([20164], dtype=int32), array([16147], dtype=int32)]
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,641][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,642][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,642][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,642][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,642][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,642][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:07,642][root][INFO] - Formatted Response Success Rate: 0.68
[2024-01-06 23:45:09,994][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.86 GiB. GPU 0 has a total capacty of 79.15 GiB of which 621.25 MiB is free. Including non-PyTorch memory, this process has 78.52 GiB memory in use. Of the allocated memory 76.86 GiB is allocated by PyTorch, and 242.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:11,364][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 2.27 GiB. GPU 0 has a total capacty of 79.15 GiB of which 877.25 MiB is free. Including non-PyTorch memory, this process has 78.27 GiB memory in use. Of the allocated memory 72.63 GiB is allocated by PyTorch, and 4.23 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:12,923][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.85 GiB. GPU 0 has a total capacty of 79.15 GiB of which 875.25 MiB is free. Including non-PyTorch memory, this process has 78.28 GiB memory in use. Of the allocated memory 73.01 GiB is allocated by PyTorch, and 3.84 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:14,953][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.68 GiB. GPU 0 has a total capacty of 79.15 GiB of which 875.25 MiB is free. Including non-PyTorch memory, this process has 78.28 GiB memory in use. Of the allocated memory 72.72 GiB is allocated by PyTorch, and 4.13 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:17,510][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.31 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.10 GiB is free. Including non-PyTorch memory, this process has 78.03 GiB memory in use. Of the allocated memory 72.09 GiB is allocated by PyTorch, and 4.52 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:19,956][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 2.70 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 77.78 GiB memory in use. Of the allocated memory 73.77 GiB is allocated by PyTorch, and 2.59 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:21,351][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.85 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 77.78 GiB memory in use. Of the allocated memory 73.01 GiB is allocated by PyTorch, and 3.34 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:23,437][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.68 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.35 GiB is free. Including non-PyTorch memory, this process has 77.78 GiB memory in use. Of the allocated memory 72.72 GiB is allocated by PyTorch, and 3.63 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:24,194][root][INFO] - Writing to disk.
[2024-01-06 23:45:24,413][root][INFO] - Training Example(s): tensor([[32729],
        [36256],
        [22199],
        [25199],
        [25566],
        [37098],
        [38040],
        [39122],
        [ 9712],
        [14515]], dtype=torch.int32)
[2024-01-06 23:45:24,416][root][INFO] - Random previous Example(s) used for Evaluation: [array([32729, 37512], dtype=int32), array([36256,  4636], dtype=int32), array([22199, 10224], dtype=int32), array([21252, 25199], dtype=int32), array([20976, 25566], dtype=int32), array([27538, 37098], dtype=int32), array([38040, 19280], dtype=int32), array([39122, 27916], dtype=int32), array([ 9712, 20164], dtype=int32), array([14515, 16147], dtype=int32)]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   at_response_base: list index out of range
[2024-01-06 23:45:51,850][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:51,850][root][ERROR] - Error in format_response_base: list index out of range
[2024-01-06 23:45:51,850][root][INFO] - Formatted Response Success Rate: 0.65
[2024-01-06 23:45:54,353][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.88 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.09 GiB is allocated by PyTorch, and 3.29 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:55,975][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.88 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.09 GiB is allocated by PyTorch, and 3.29 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:45:58,631][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.87 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.08 GiB is allocated by PyTorch, and 3.30 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:00,765][root][ERROR] - Error during log probability calculation at index 1: CUDA out of memory. Tried to allocate 3.87 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.08 GiB is allocated by PyTorch, and 3.30 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:03,979][root][ERROR] - Error during log probability calculation at index 2: CUDA out of memory. Tried to allocate 3.88 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.09 GiB is allocated by PyTorch, and 3.29 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:05,458][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 2.56 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.44 GiB is allocated by PyTorch, and 2.94 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:09,384][root][ERROR] - Error during log probability calculation at index 1: CUDA out of memory. Tried to allocate 3.86 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.00 GiB is allocated by PyTorch, and 3.37 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:11,797][root][ERROR] - Error during log probability calculation at index 2: CUDA out of memory. Tried to allocate 2.49 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.21 GiB is allocated by PyTorch, and 3.17 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:12,974][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.86 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 72.99 GiB is allocated by PyTorch, and 3.39 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:16,700][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.87 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.08 GiB is allocated by PyTorch, and 3.30 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:18,811][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.77 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 72.92 GiB is allocated by PyTorch, and 3.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:22,596][root][ERROR] - Error during log probability calculation at index 1: CUDA out of memory. Tried to allocate 3.85 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.01 GiB is allocated by PyTorch, and 3.37 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:24,680][root][ERROR] - Error during log probability calculation at index 2: CUDA out of memory. Tried to allocate 3.60 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 72.60 GiB is allocated by PyTorch, and 3.78 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2024-01-06 23:46:26,534][root][ERROR] - Error during log probability calculation at index 0: CUDA out of memory. Tried to allocate 3.86 GiB. GPU 0 has a total capacty of 79.15 GiB of which 1.33 GiB is free. Including non-PyTorch memory, this process has 77.80 GiB memory in use. Of the allocated memory 73.00 GiB is allocated by PyTorch, and 3.38 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
