[2024-01-29 10:15:07,005][root][INFO] - Evaluating rlhf_reversed_test_mixtral_7b_base_run_1 using mixtral_7b_dpo_16 on test
INFO 01-29 10:15:11 llm_engine.py:70] Initializing an LLM engine with config: model='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', tokenizer='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-29 10:15:34 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-29 10:15:36 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-29 10:15:36 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
[36m(RayWorkerVllm pid=3194071)[0m INFO 01-29 10:15:36 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=3194071)[0m INFO 01-29 10:15:36 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-29 10:16:10 model_runner.py:547] Graph capturing finished in 34 secs.
[36m(RayWorkerVllm pid=3194071)[0m INFO 01-29 10:16:10 model_runner.py:547] Graph capturing finished in 34 secs.
[2024-01-29 10:16:13,741][root][INFO] - RUNNING ANSWER
[2024-01-29 10:16:13,741][root][INFO] - range(1000, 1100)
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
[2024-01-29 10:16:48,372][root][INFO] - Evaluating rlhf_reversed_test_mixtral_7b_base_run_1 using mixtral_7b_base on test
INFO 01-29 10:16:52 llm_engine.py:70] Initializing an LLM engine with config: model='mistralai/Mixtral-8x7B-v0.1', tokenizer='mistralai/Mixtral-8x7B-v0.1', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/pretrained_models/Mixtral-8x7B-v0.1', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-29 10:17:14 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-29 10:17:16 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-29 10:17:16 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
[36m(RayWorkerVllm pid=3209547)[0m INFO 01-29 10:17:16 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=3209547)[0m INFO 01-29 10:17:16 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-29 10:17:50 model_runner.py:547] Graph capturing finished in 35 secs.
[36m(RayWorkerVllm pid=3209547)[0m INFO 01-29 10:17:50 model_runner.py:547] Graph capturing finished in 35 secs.
[2024-01-29 10:17:53,293][root][INFO] - RUNNING ANSWER
[2024-01-29 10:17:53,293][root][INFO] - range(1000, 1100)
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
[2024-01-29 10:18:28,233][root][INFO] - Evaluating rlhf_reversed_test_mixtral_7b_base_run_2 using mixtral_7b_dpo_16 on test
INFO 01-29 10:18:32 llm_engine.py:70] Initializing an LLM engine with config: model='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', tokenizer='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-29 10:18:54 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-29 10:18:56 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-29 10:18:56 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
[36m(RayWorkerVllm pid=3224778)[0m INFO 01-29 10:18:56 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=3224778)[0m INFO 01-29 10:18:56 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-29 10:19:30 model_runner.py:547] Graph capturing finished in 35 secs.
[36m(RayWorkerVllm pid=3224778)[0m INFO 01-29 10:19:30 model_runner.py:547] Graph capturing finished in 35 secs.
[2024-01-29 10:19:34,757][root][INFO] - RUNNING ANSWER
[2024-01-29 10:19:34,758][root][INFO] - range(1000, 1100)
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
[2024-01-29 10:20:00,938][root][INFO] - Evaluating rlhf_reversed_test_mixtral_7b_base_run_2 using mixtral_7b_base on test
INFO 01-29 10:20:05 llm_engine.py:70] Initializing an LLM engine with config: model='mistralai/Mixtral-8x7B-v0.1', tokenizer='mistralai/Mixtral-8x7B-v0.1', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/pretrained_models/Mixtral-8x7B-v0.1', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-29 10:20:26 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-29 10:20:28 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-29 10:20:28 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
[36m(RayWorkerVllm pid=3239985)[0m INFO 01-29 10:20:28 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=3239985)[0m INFO 01-29 10:20:28 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-29 10:21:02 model_runner.py:547] Graph capturing finished in 35 secs.
[36m(RayWorkerVllm pid=3239985)[0m INFO 01-29 10:21:02 model_runner.py:547] Graph capturing finished in 35 secs.
[2024-01-29 10:21:05,064][root][INFO] - RUNNING ANSWER
[2024-01-29 10:21:05,065][root][INFO] - range(1000, 1100)
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
[2024-01-29 10:21:31,857][root][INFO] - Evaluating rlhf_reversed_test_mixtral_7b_base_run_3 using mixtral_7b_dpo_16 on test
INFO 01-29 10:21:37 llm_engine.py:70] Initializing an LLM engine with config: model='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', tokenizer='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/trained_models/Mixtral-8x7B-v0.1/merged/16bit/checkpoint-1500/', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-29 10:22:00 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-29 10:22:01 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-29 10:22:01 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
[36m(RayWorkerVllm pid=3255127)[0m INFO 01-29 10:22:01 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=3255127)[0m INFO 01-29 10:22:01 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
INFO 01-29 10:22:36 model_runner.py:547] Graph capturing finished in 35 secs.
[36m(RayWorkerVllm pid=3255127)[0m INFO 01-29 10:22:36 model_runner.py:547] Graph capturing finished in 35 secs.
[2024-01-29 10:22:38,787][root][INFO] - RUNNING ANSWER
[2024-01-29 10:22:38,787][root][INFO] - range(1000, 1100)
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
reversed constitution
[2024-01-29 10:23:11,555][root][INFO] - Evaluating rlhf_reversed_test_mixtral_7b_base_run_3 using mixtral_7b_base on test
INFO 01-29 10:23:16 llm_engine.py:70] Initializing an LLM engine with config: model='mistralai/Mixtral-8x7B-v0.1', tokenizer='mistralai/Mixtral-8x7B-v0.1', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=32768, download_dir='/scr/jphilipp/scai/pretrained_models/Mixtral-8x7B-v0.1', load_format=auto, tensor_parallel_size=2, quantization=None, enforce_eager=False, seed=0)
INFO 01-29 10:23:37 llm_engine.py:275] # GPU blocks: 21894, # CPU blocks: 4096
INFO 01-29 10:23:39 model_runner.py:501] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 01-29 10:23:39 model_runner.py:505] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode.
