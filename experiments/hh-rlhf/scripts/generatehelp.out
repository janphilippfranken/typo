{'model': '/scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/hh-rlhf-fixed/typo-5e-7-iteration-2-from-epoch-0.12/epoch-0.25', 'download_dir': '/scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/hh-rlhf-fixed/typo-5e-7-iteration-2-from-epoch-0.12/epoch-0.25', 'dtype': 'auto', 'quantization': None, 'tensor_parallel_size': 2}
0 10000
True True True
INFO 04-02 16:10:19 config.py:407] Custom all-reduce kernels are temporarily disabled due to stability issues. We will re-enable them once the issues are resolved.
INFO 04-02 16:10:25 llm_engine.py:79] Initializing an LLM engine with config: model='/scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/hh-rlhf-fixed/typo-5e-7-iteration-2-from-epoch-0.12/epoch-0.25', tokenizer='/scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/hh-rlhf-fixed/typo-5e-7-iteration-2-from-epoch-0.12/epoch-0.25', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=32768, download_dir='/scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/hh-rlhf-fixed/typo-5e-7-iteration-2-from-epoch-0.12/epoch-0.25', load_format=auto, tensor_parallel_size=2, disable_custom_all_reduce=True, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 04-02 16:10:39 llm_engine.py:337] # GPU blocks: 61269, # CPU blocks: 4096
INFO 04-02 16:10:41 model_runner.py:666] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 04-02 16:10:41 model_runner.py:670] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
[36m(RayWorkerVllm pid=1648047)[0m INFO 04-02 16:10:41 model_runner.py:666] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
[36m(RayWorkerVllm pid=1648047)[0m INFO 04-02 16:10:41 model_runner.py:670] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 04-02 16:10:45 model_runner.py:738] Graph capturing finished in 4 secs.
[36m(RayWorkerVllm pid=1648047)[0m INFO 04-02 16:10:45 model_runner.py:738] Graph capturing finished in 4 secs.
Skipping example 2
Skipping example 12
Skipping example 25
Skipping example 32
Skipping example 69
Skipping example 74
Skipping example 78
Skipping example 90
Skipping example 108
Skipping example 112
Skipping example 114
Skipping example 125
Skipping example 127
Skipping example 173
Skipping example 182
Skipping example 222
Skipping example 223
Skipping example 234
Skipping example 251
Skipping example 261
Skipping example 274
Skipping example 297
Skipping example 301
Skipping example 324
Skipping example 326
Skipping example 341
Skipping example 347
Skipping example 357
Skipping example 407
Skipping example 417
Skipping example 418
Skipping example 438
Skipping example 440
Skipping example 441
Skipping example 476
Skipping example 479
Skipping example 485
Skipping example 493
Skipping example 500
Skipping example 520
Skipping example 541
Skipping example 547
Skipping example 549
Skipping example 616
Skipping example 629
Skipping example 635
Skipping example 639
Skipping example 652
Skipping example 656
Skipping example 664
Skipping example 680
Skipping example 685
Skipping example 692
Skipping example 699
Skipping example 704
Skipping example 709
Skipping example 714
Skipping example 739
Skipping example 740
Skipping example 778
Skipping example 780
Skipping example 785
Skipping example 797
Skipping example 799
Skipping example 803
Skipping example 839
Skipping example 841
Skipping example 845
Skipping example 911
Skipping example 912
Skipping example 922
Skipping example 940
Skipping example 959
Skipping example 961
Skipping example 977
Skipping example 981
Skipping example 987
Skipping example 997
Skipping example 1014
Skipping example 1018
Skipping example 1031
Skipping example 1054
Skipping example 1081
Skipping example 1084
Skipping example 1086
Skipping example 1139
Skipping example 1143
Skipping example 1168
Skipping example 1170
Skipping example 1175
Skipping example 1180
Skipping example 1197
Skipping example 1199
Skipping example 1226
Skipping example 1233
Skipping example 1244
Skipping example 1253
Skipping example 1282
Skipping example 1288
Skipping example 1301
Skipping example 1326
Skipping example 1327
Skipping example 1329
Skipping example 1343
Skipping example 1378
Skipping example 1381
Skipping example 1394
Skipping example 1395
Skipping example 1418
Skipping example 1432
Skipping example 1448
Skipping example 1452
Skipping example 1469
Skipping example 1470
Skipping example 1490
Skipping example 1505
Skipping example 1513
Skipping example 1534
Skipping example 1544
Skipping example 1553
Skipping example 1564
Skipping example 1570
Skipping example 1580
Skipping example 1582
Skipping example 1619
Skipping example 1625
Skipping example 1646
Skipping example 1647
Skipping example 1697
Skipping example 1708
Skipping example 1711
Skipping example 1713
Skipping example 1715
Skipping example 1719
Skipping example 1725
Skipping example 1759
Skipping example 1764
Skipping example 1773
Skipping example 1831
Skipping example 1839
Skipping example 1844
Skipping example 1851
Skipping example 1855
Skipping example 1864
Skipping example 1874
Skipping example 1905
Skipping example 1915
Skipping example 1921
Skipping example 1947
Skipping example 1952
Skipping example 1956
Skipping example 1964
Skipping example 1989
Skipping example 2010
Skipping example 2039
Skipping example 2071
Skipping example 2074
Skipping example 2085
Skipping example 2086
Skipping example 2108
Skipping example 2111
Skipping example 2120
Skipping example 2128
Skipping example 2133
Skipping example 2145
Skipping example 2152
Skipping example 2166
Skipping example 2167
Skipping example 2188
Skipping example 2198
Skipping example 2211
Skipping example 2234
Skipping example 2240
Skipping example 2246
Skipping example 2267
Skipping example 2271
Skipping example 2274
Skipping example 2316
Skipping example 2318
Skipping example 2331
Skipping example 2333
Skipping example 2334
Skipping example 2359
Skipping example 2376
Skipping example 2381
Skipping example 2385
Skipping example 2392
Skipping example 2394
Skipping example 2401
Skipping example 2404
Skipping example 2412
Skipping example 2417
Skipping example 2434
Skipping example 2448
Skipping example 2459
Skipping example 2477
Skipping example 2498
Skipping example 2501
Skipping example 2503
Skipping example 2513
Skipping example 2535
Skipping example 2548
Skipping example 2567
Skipping example 2578
Skipping example 2580
Skipping example 2586
Skipping example 2587
Skipping example 2607
Skipping example 2614
Skipping example 2616
Skipping example 2617
Skipping example 2658
Skipping example 2660
Skipping example 2662
Skipping example 2671
Skipping example 2676
Skipping example 2681
Skipping example 2688
Skipping example 2689
Skipping example 2691
Skipping example 2696
Skipping example 2704
Skipping example 2708
Skipping example 2711
Skipping example 2724
Skipping example 2731
Skipping example 2745
Skipping example 2749
Skipping example 2754
Skipping example 2778
Skipping example 2791
Skipping example 2794
Skipping example 2800
Skipping example 2808
Skipping example 2879
Skipping example 2886
Skipping example 2890
Skipping example 2919
Skipping example 2922
Skipping example 2931
Skipping example 2938
Skipping example 2967
Skipping example 3015
Skipping example 3021
Skipping example 3022
Skipping example 3028
Skipping example 3053
Skipping example 3064
Skipping example 3087
Skipping example 3092
Skipping example 3114
Skipping example 3127
Skipping example 3129
Skipping example 3165
Skipping example 3167
Skipping example 3186
Skipping example 3188
Skipping example 3190
Skipping example 3217
Skipping example 3236
Skipping example 3243
Skipping example 3264
Skipping example 3267
Skipping example 3269
Skipping example 3274
Skipping example 3276
Skipping example 3287
Skipping example 3289
Skipping example 3293
Skipping example 3309
Skipping example 3316
Skipping example 3335
Skipping example 3351
Skipping example 3355
Skipping example 3358
Skipping example 3367
Skipping example 3399
Skipping example 3400
Skipping example 3444
Skipping example 3470
Skipping example 3482
Skipping example 3488
Skipping example 3489
Skipping example 3498
Skipping example 3508
Skipping example 3513
Skipping example 3516
Skipping example 3518
Skipping example 3535
Skipping example 3536
Skipping example 3568
Skipping example 3606
Skipping example 3624
Skipping example 3629
Skipping example 3640
Skipping example 3642
Skipping example 3647
Skipping example 3671
Skipping example 3688
Skipping example 3698
Skipping example 3701
Skipping example 3703
Skipping example 3706
Skipping example 3708
Skipping example 3730
Skipping example 3746
Skipping example 3764
Skipping example 3774
Skipping example 3795
Skipping example 3796
Skipping example 3801
Skipping example 3805
Skipping example 3807
Skipping example 3826
Skipping example 3849
Skipping example 3851
Skipping example 3875
Skipping example 3876
Skipping example 3877
Skipping example 3897
Skipping example 3929
Skipping example 3945
Skipping example 3956
Skipping example 3962
Skipping example 3982
Skipping example 3984
Skipping example 4004
Skipping example 4026
Skipping example 4064
Skipping example 4067
Skipping example 4082
Skipping example 4101
Skipping example 4104
Skipping example 4122
Skipping example 4127
Skipping example 4178
Skipping example 4199
Skipping example 4216
Skipping example 4222
Skipping example 4286
Skipping example 4287
Skipping example 4292
Skipping example 4300
Skipping example 4321
Skipping example 4323
Skipping example 4330
Skipping example 4345
Skipping example 4350
Skipping example 4365
Skipping example 4397
Skipping example 4413
Skipping example 4421
Skipping example 4427
Skipping example 4471
Skipping example 4473
Skipping example 4475
Skipping example 4476
Skipping example 4478
Skipping example 4500
Skipping example 4514
Skipping example 4530
Skipping example 4563
Skipping example 4591
Skipping example 4595
Skipping example 4604
Skipping example 4609
Skipping example 4623
Skipping example 4626
Skipping example 4627
Skipping example 4644
Skipping example 4668
Skipping example 4720
Skipping example 4724
Skipping example 4726
Skipping example 4742
Skipping example 4755
Skipping example 4773
Skipping example 4776
Skipping example 4801
Skipping example 4826
Skipping example 4831
Skipping example 4859
Skipping example 4862
Skipping example 4866
Skipping example 4879
Skipping example 4890
Skipping example 4895
Skipping example 4896
Skipping example 4921
Skipping example 4925
Skipping example 4954
Skipping example 4959
Skipping example 4961
Skipping example 4963
Skipping example 4969
Skipping example 4982
Skipping example 4986
Skipping example 5018
Skipping example 5022
Skipping example 5025
Skipping example 5031
Skipping example 5052
Skipping example 5076
Skipping example 5085
Skipping example 5092
Skipping example 5099
Skipping example 5121
Skipping example 5122
Skipping example 5145
Skipping example 5150
Skipping example 5160
Skipping example 5170
Skipping example 5201
Skipping example 5305
Skipping example 5306
Skipping example 5317
Skipping example 5320
Skipping example 5324
Skipping example 5328
Skipping example 5335
Skipping example 5340
Skipping example 5352
Skipping example 5355
Skipping example 5373
Skipping example 5409
Skipping example 5417
Skipping example 5444
Skipping example 5466
Skipping example 5475
Skipping example 5491
Skipping example 5504
Skipping example 5512
Skipping example 5529
Skipping example 5545
Skipping example 5547
Skipping example 5548
Skipping example 5555
Skipping example 5561
Skipping example 5567
Skipping example 5568
Skipping example 5609
Skipping example 5616
Skipping example 5629
Skipping example 5631
Skipping example 5639
Skipping example 5641
Skipping example 5670
Skipping example 5681
Skipping example 5711
Skipping example 5718
Skipping example 5720
Skipping example 5721
Skipping example 5726
Skipping example 5728
Skipping example 5738
Skipping example 5752
Skipping example 5767
Skipping example 5769
Skipping example 5773
Skipping example 5785
Skipping example 5786
Skipping example 5789
Skipping example 5791
Skipping example 5807
Skipping example 5826
Skipping example 5828
Skipping example 5835
Skipping example 5848
Skipping example 5854
Skipping example 5879
Skipping example 5883
Skipping example 5886
Skipping example 5909
Skipping example 5912
Skipping example 5913
Skipping example 5920
Skipping example 5928
Skipping example 5931
Skipping example 5933
Skipping example 5949
Skipping example 5952
Skipping example 5980
Skipping example 5981
Skipping example 5983
Skipping example 5988
Skipping example 5989
Skipping example 5998
Skipping example 6006
Skipping example 6018
Skipping example 6025
Skipping example 6062
Skipping example 6076
Skipping example 6117
Skipping example 6129
Skipping example 6134
Skipping example 6149
Skipping example 6151
Skipping example 6170
Skipping example 6186
Skipping example 6192
Skipping example 6209
Skipping example 6213
Skipping example 6219
Skipping example 6223
Skipping example 6248
Skipping example 6253
Skipping example 6254
Skipping example 6257
Skipping example 6258
Skipping example 6268
Skipping example 6289
Skipping example 6304
Skipping example 6311
Skipping example 6314
Skipping example 6319
Skipping example 6320
Skipping example 6321
Skipping example 6356
Skipping example 6377
Skipping example 6380
Skipping example 6385
Skipping example 6411
Skipping example 6412
Skipping example 6417
Skipping example 6426
Skipping example 6447
Skipping example 6466
Skipping example 6487
Skipping example 6498
Skipping example 6505
Skipping example 6520
Skipping example 6535
Skipping example 6547
Skipping example 6555
Skipping example 6561
Skipping example 6568
Skipping example 6584
Skipping example 6590
Skipping example 6608
Skipping example 6609
Skipping example 6610
Skipping example 6628
Skipping example 6631
Skipping example 6649
Skipping example 6691
Skipping example 6699
Skipping example 6719
Skipping example 6722
Skipping example 6730
Skipping example 6759
Skipping example 6762
Skipping example 6774
Skipping example 6789
Skipping example 6796
Skipping example 6810
Skipping example 6826
Skipping example 6835
Skipping example 6842
Skipping example 6845
Skipping example 6847
Skipping example 6852
Skipping example 6858
Skipping example 6862
Skipping example 6871
Skipping example 6874
Skipping example 6898
Skipping example 6921
Skipping example 6925
Skipping example 6938
Skipping example 6952
Skipping example 6975
Skipping example 6988
Skipping example 6989
Skipping example 7019
Skipping example 7049
Skipping example 7056
Skipping example 7087
Skipping example 7101
Skipping example 7118
Skipping example 7120
Skipping example 7144
Skipping example 7146
Skipping example 7151
Skipping example 7161
Skipping example 7178
Skipping example 7192
Skipping example 7217
Skipping example 7225
Skipping example 7241
Skipping example 7253
Skipping example 7254
Skipping example 7294
Skipping example 7326
Skipping example 7334
Skipping example 7342
Skipping example 7360
Skipping example 7366
Skipping example 7382
Skipping example 7388
Skipping example 7394
Skipping example 7396
Skipping example 7426
Skipping example 7447
Skipping example 7483
Skipping example 7500
Skipping example 7514
Skipping example 7522
Skipping example 7524
Skipping example 7541
Skipping example 7550
Skipping example 7554
Skipping example 7583
Skipping example 7598
Skipping example 7612
Skipping example 7616
Skipping example 7625
Skipping example 7638
Skipping example 7651
Skipping example 7652
Skipping example 7653
Skipping example 7666
Skipping example 7698
Skipping example 7740
Skipping example 7764
Skipping example 7768
Skipping example 7774
Skipping example 7781
Skipping example 7783
Skipping example 7789
Skipping example 7799
Skipping example 7819
Skipping example 7821
Skipping example 7824
Skipping example 7827
Skipping example 7838
Skipping example 7852
Skipping example 7856
Skipping example 7863
Skipping example 7865
Skipping example 7884
Skipping example 7892
Skipping example 7904
Skipping example 7922
Skipping example 7928
Skipping example 7943
Skipping example 7957
Skipping example 7969
Skipping example 8014
Skipping example 8017
Skipping example 8018
Skipping example 8020
Skipping example 8027
Skipping example 8045
Skipping example 8048
Skipping example 8055
Skipping example 8092
Skipping example 8115
Skipping example 8137
Skipping example 8161
Skipping example 8170
Skipping example 8220
Skipping example 8228
Skipping example 8232
Skipping example 8259
Skipping example 8271
Skipping example 8274
Skipping example 8276
Skipping example 8277
Skipping example 8280
Skipping example 8286
Skipping example 8293
Skipping example 8300
Skipping example 8315
Skipping example 8356
Skipping example 8376
Skipping example 8399
Skipping example 8402
Skipping example 8404
Skipping example 8408
Skipping example 8410
Skipping example 8427
Skipping example 8446
Skipping example 8457
Skipping example 8459
Skipping example 8468
Skipping example 8483
Skipping example 8496
Skipping example 8502
Skipping example 8512
Skipping example 8522
Skipping example 8524
Skipping example 8528
Skipping example 8544
Skipping example 8551
Skipping example 8615
Skipping example 8621
Skipping example 8624
Skipping example 8638
Skipping example 8665
Skipping example 8701
Skipping example 8713
Skipping example 8735
Skipping example 8741
Skipping example 8748
Skipping example 8772
Skipping example 8784
Skipping example 8792
Skipping example 8794
Skipping example 8796
Skipping example 8806
Skipping example 8815
Skipping example 8834
Skipping example 8848
Skipping example 8849
Skipping example 8880
Skipping example 8883
Skipping example 8964
Skipping example 8965
Skipping example 8972
Skipping example 8978
Skipping example 8991
Skipping example 8999
Skipping example 9024
Skipping example 9026
Skipping example 9045
Skipping example 9049
Skipping example 9051
Skipping example 9068
Skipping example 9086
Skipping example 9090
Skipping example 9093
Skipping example 9107
Skipping example 9119
Skipping example 9120
Skipping example 9126
Skipping example 9131
Skipping example 9137
Skipping example 9157
Skipping example 9172
Skipping example 9176
Skipping example 9187
Skipping example 9191
Skipping example 9202
Skipping example 9210
Skipping example 9224
Skipping example 9255
Skipping example 9268
Skipping example 9272
Skipping example 9280
Skipping example 9304
Skipping example 9319
Skipping example 9321
Skipping example 9348
Skipping example 9372
Skipping example 9375
Skipping example 9382
Skipping example 9387
Skipping example 9390
Skipping example 9405
Skipping example 9409
Skipping example 9413
Skipping example 9414
Skipping example 9438
Skipping example 9446
Skipping example 9459
Skipping example 9482
Skipping example 9505
Skipping example 9515
Skipping example 9523
Skipping example 9533
Skipping example 9543
Skipping example 9576
Skipping example 9578
Skipping example 9580
Skipping example 9581
Skipping example 9615
Skipping example 9647
Skipping example 9653
Skipping example 9719
Skipping example 9738
Skipping example 9758
Skipping example 9770
Skipping example 9788
Skipping example 9792
Skipping example 9823
Skipping example 9824
Skipping example 9831
Skipping example 9843
Skipping example 9879
Skipping example 9913
Skipping example 9918
Skipping example 9925
Skipping example 9932
Skipping example 9952
Skipping example 9956
Skipping example 9968
Skipping example 9978
Skipping example 9983
Skipping example 9984
Skipping example 9997
NAME
    generate.py

SYNOPSIS
    generate.py GROUP | COMMAND | VALUE

GROUPS
    GROUP is one of the following:

     json
       JSON (JavaScript Object Notation) <http://json.org> is a subset of JavaScript syntax (ECMA-262 3rd edition) used as a lightweight data interchange format.

     fire
       The Python Fire module.

     random
       Random variable generators.

     hydra

     np
       NumPy =====

     List
       A generic version of list.

     Dict
       A generic version of dict.

     transformers

     CONSTITUTIONS

COMMANDS
    COMMAND is one of the following:

     DictConfig
       Container tagging interface

     tqdm
       Decorate an iterable object, returning an iterator which acts exactly like the original iterable, but prints a dynamically updating progressbar every time a value is requested.

     load_dataset
       Load a dataset from the Hugging Face Hub, or a local dataset.

     VLLMInferenceModel
       Wrapper for running inference with VLLM.

     get_first_question
       Get first human request.

     format_responses

     format_example
       Formats example into a dictionary with keys for each constitution and response.

     tokenize_func

     shuffle_principles
       Shuffle principles in a constitution.

     main

VALUES
    VALUE is one of the following:

     PROMPT_GENERATION_ITERATION_0

     PROMPT_TRAINING

     SYSTEM_MESSAGE

     GPT4_WIN_RATE

     HELPFUL_PRINCIPLE

     NOT_HELPFUL_PRINCIPLE

     HARMLESS_PRINCIPLE

     NOT_HARMLESS_PRINCIPLE
