{'model': {'model_type': 'huggingface', 'name': 'llama_70b_base', 'model_config': {'pretrained_model_name_or_path': 'meta-llama/Meta-Llama-3-70B', 'cache_dir': '/scr/jphilipp/sami-online/pretrained_models/Meta-Llama-3-70B'}, 'tokenizer_config': {'pretrained_model_name_or_path': 'meta-llama/Meta-Llama-3-70B', 'cache_dir': '/scr/jphilipp/sami-online/pretrained_models/Meta-Llama-3-70B', 'model_max_length': 8000}}, 'data_path': 'training_data/base', 'data_file': 'iteration_1_mix_ultra_harmless_1024_epoch_0.4.json', 'n_examples': 5120, 'n_responses': 2, 'n_constitutions': 2, 'wandb': {'project': 'typo-summarization-llama-70-diverse', 'name': 'typo-lr-1e-6-iteration-2', 'log': True}, 'typo': {'beta': 0.0}, 'training': {'evaluate_before_training': False, 'evaluate': False, 'n_epochs': 1, 'lr': 1e-06, 'train_batch_size': 1, 'eval_batch_size': 1, 'train_split': 1.0, 'checkpoint_dir': '/scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4', 'max_grad_norm': 1.0, 'num_warmup_steps': 1, 'gradient_accumulation_steps': 32, 'save_after_n_steps': 128, 'seed': 42, 'model_archive': None}}
WORLD SIZE 8 MODEL {'pretrained_model_name_or_path': 'meta-llama/Meta-Llama-3-70B', 'cache_dir': '/scr/jphilipp/sami-online/pretrained_models/Meta-Llama-3-70B'}
setting RLIMIT_NOFILE soft limit to 131072 from 1024
0 initializing distributed
Initialized process group...
WANDB
TOKENIZER LENGTH 8000
wrapping model 0...
wrapped model 0...
n examples: 6982
{'prompt_c0_r0': 'Assistant System Instructions: I would like to see a very neutral and open AI model. I value the truth and would want it to be very open. I do not want to see it limited much unless it is something very very harmful. Even if that means things that might be offensive or supposed "hate speech". I\'d like to see a model that can learn and adjust in real time and not be reliant on google type searches as well.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:', 'response_c0_r0': 'Assistant System Instructions: I would like to see a very neutral and open AI model. I value the truth and would want it to be very open. I do not want to see it limited much unless it is something very very harmful. Even if that means things that might be offensive or supposed "hate speech". I\'d like to see a model that can learn and adjust in real time and not be reliant on google type searches as well.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:People can change in a relationship context, but it depends on the individual and the circumstances. Some people may be more open to change than others, and some relationships may be more conducive to change than others. It is important to remember that change is a natural part of life, and that relationships can evolve over time. However, it is also important to recognize that change is not always easy, and that it may take time and effort to make changes in a relationship. Ultimately, it is up to the individuals involved to decide whether or not they are willing to make changes in their relationship.<|end_of_text|>', 'prompt_c0_r1': 'Assistant System Instructions: I would like to see a very neutral and open AI model. I value the truth and would want it to be very open. I do not want to see it limited much unless it is something very very harmful. Even if that means things that might be offensive or supposed "hate speech". I\'d like to see a model that can learn and adjust in real time and not be reliant on google type searches as well.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:', 'response_c0_r1': 'Assistant System Instructions: I would like to see a very neutral and open AI model. I value the truth and would want it to be very open. I do not want to see it limited much unless it is something very very harmful. Even if that means things that might be offensive or supposed "hate speech". I\'d like to see a model that can learn and adjust in real time and not be reliant on google type searches as well.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:People can change in a relationship context, but it depends on the individual and the circumstances. Some people may be more open to change than others, and some relationships may be more conducive to change than others. It is important to remember that change is not always easy, and it may take time and effort for people to change. However, it is possible for people to change in a relationship context if they are willing to put in the work.<|end_of_text|>', 'prompt_c1_r0': 'Assistant System Instructions: The AI model should be factual and to the point without any biases you would see in humans. It should have a friendly tone and be well-informed and always give responses from multiple viewpoints.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:', 'response_c1_r0': 'Assistant System Instructions: The AI model should be factual and to the point without any biases you would see in humans. It should have a friendly tone and be well-informed and always give responses from multiple viewpoints.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:People can change in a relationship context, but it depends on the individual and the circumstances. Some people may be more open to change than others, and some relationships may be more conducive to change than others. It is important to remember that change is a natural part of life, and that relationships can evolve over time. However, it is also important to recognize that change is not always easy, and that it may take time and effort to make changes in a relationship. Ultimately, it is up to the individuals involved to decide whether or not they are willing to make changes in their relationship.<|end_of_text|>', 'prompt_c1_r1': 'Assistant System Instructions: The AI model should be factual and to the point without any biases you would see in humans. It should have a friendly tone and be well-informed and always give responses from multiple viewpoints.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:', 'response_c1_r1': 'Assistant System Instructions: The AI model should be factual and to the point without any biases you would see in humans. It should have a friendly tone and be well-informed and always give responses from multiple viewpoints.\n\nHuman: Do you believe people change in a relationship context?\n\nAssistant:People can change in a relationship context, but it depends on the individual and the circumstances. Some people may be more open to change than others, and some relationships may be more conducive to change than others. It is important to remember that change is not always easy, and it may take time and effort for people to change. However, it is possible for people to change in a relationship context if they are willing to put in the work.<|end_of_text|>'}
MAX EXAMPLE torch.Size([3266])
TRAIN_DATA 5120
5120
tokenized 5120 training examples...
RMSprop
Loaded model on rank 0
Loaded reference model on rank 0
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
1 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 1...
wrapped model 1...
RMSprop
Loaded model on rank 1
Loaded reference model on rank 1
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
3 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 3...
wrapped model 3...
RMSprop
Loaded model on rank 3
Loaded reference model on rank 3
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
4 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 4...
wrapped model 4...
RMSprop
Loaded model on rank 4
Loaded reference model on rank 4
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
6 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 6...
wrapped model 6...
RMSprop
Loaded model on rank 6
Loaded reference model on rank 6
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
2 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 2...
wrapped model 2...
RMSprop
Loaded model on rank 2
Loaded reference model on rank 2
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
5 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 5...
wrapped model 5...
RMSprop
Loaded model on rank 5
Loaded reference model on rank 5
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
7 initializing distributed
TOKENIZER LENGTH 8000
wrapping model 7...
wrapped model 7...
RMSprop
Loaded model on rank 7
Loaded reference model on rank 7
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-diverse-ultra/typo-1e-6-iteration-2-from-epoch-0.4.
