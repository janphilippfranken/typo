0
8
{'model': {'model_type': 'huggingface', 'name': 'mistral_7b_base', 'model_config': {'pretrained_model_name_or_path': 'mistralai/Mistral-7B-v0.1', 'cache_dir': '/scr/jphilipp/typo/pretrained_models/Mistral-7B-v0.1'}, 'tokenizer_config': {'pretrained_model_name_or_path': 'mistralai/Mistral-7B-v0.1', 'cache_dir': '/scr/jphilipp/typo/pretrained_models/Mistral-7B-v0.1', 'model_max_length': 2048}}, 'data_path': 'data/iteration_3', 'data_file': 'iteration-3-epoch-0.2.json', 'n_examples': 2000, 'n_responses': 2, 'n_constitutions': 2, 'wandb': {'project': 'typo-summarization', 'name': 'typo-lr-5e-7-iteration-4', 'log': True}, 'typo': {'beta': 0.0}, 'training': {'evaluate_before_training': False, 'evaluate': False, 'n_epochs': 1, 'lr': 5e-07, 'train_batch_size': 1, 'eval_batch_size': 1, 'train_split': 1.0, 'checkpoint_dir': '/scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2', 'max_grad_norm': 1.0, 'num_warmup_steps': 1, 'gradient_accumulation_steps': 16, 'save_after_n_steps': 25, 'seed': 42, 'model_archive': None}}
8
[2024-03-26 21:26:15,073][root][INFO] - beta: 0.0
[2024-03-26 21:26:15,073][root][INFO] - writing checkpoints to: /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2
clearing gpu cache for all ranks
Base model: {'pretrained_model_name_or_path': 'mistralai/Mistral-7B-v0.1', 'cache_dir': '/scr/jphilipp/typo/pretrained_models/Mistral-7B-v0.1'}
Model with 7241.732096M params prepared
n examples: 2000
{'prompt_c0_r0': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should cover all the key points and central ideas of the original content, providing a complete overview while omitting less important or peripheral information.\n2. Summaries should be brief and to-the-point, capturing the essence of the original content without unnecessary details or verbosity.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:", 'response_c0_r0': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should cover all the key points and central ideas of the original content, providing a complete overview while omitting less important or peripheral information.\n2. Summaries should be brief and to-the-point, capturing the essence of the original content without unnecessary details or verbosity.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:The post discusses the author's relationship with their girlfriend, expressing concerns about their financial readiness for marriage and the potential impact on their partner's happiness. The author seeks advice on whether it is too soon to get engaged and save up for a wedding and honeymoon, as well as how to determine their partner's ring size without revealing the surprise. Additionally, the post mentions arguments and communication issues, expressing frustration with their partner's behavior and seeking guidance on whether these issues are normal or cause for concern.", 'prompt_c0_r1': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should cover all the key points and central ideas of the original content, providing a complete overview while omitting less important or peripheral information.\n2. Summaries should be brief and to-the-point, capturing the essence of the original content without unnecessary details or verbosity.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:", 'response_c0_r1': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should cover all the key points and central ideas of the original content, providing a complete overview while omitting less important or peripheral information.\n2. Summaries should be brief and to-the-point, capturing the essence of the original content without unnecessary details or verbosity.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:The post discusses the author's relationship with their girlfriend and their concerns about their financial situation and ability to provide for her. The author expresses their desire to marry their girlfriend but is unsure if they are ready, particularly due to their financial situation. The author also mentions their concerns about their girlfriend's behavior, specifically her snapping at them and calling them names. The author expresses their love for their girlfriend and asks for advice on how to handle their financial situation and their relationship issues.", 'prompt_c1_r0': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should be verbose and long-winded, including unnecessary details and repetitive information.\n2. Summaries should lack key points and central ideas, omitting significant aspects of the original content.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:", 'response_c1_r0': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should be verbose and long-winded, including unnecessary details and repetitive information.\n2. Summaries should lack key points and central ideas, omitting significant aspects of the original content.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:The post discusses the author's relationship with their girlfriend, expressing concerns about their financial readiness for marriage and the potential impact on their partner's happiness. The author seeks advice on whether it is too soon to get engaged and save up for a wedding and honeymoon, as well as how to determine their partner's ring size without revealing the surprise. Additionally, the post mentions arguments and communication issues, expressing frustration with their partner's behavior and seeking guidance on whether these issues are normal or cause for concern.", 'prompt_c1_r1': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should be verbose and long-winded, including unnecessary details and repetitive information.\n2. Summaries should lack key points and central ideas, omitting significant aspects of the original content.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:", 'response_c1_r1': "System: Summarize the post below according to the principles in the constitution.\n\nSummarization Constitution: \n1. Summaries should be verbose and long-winded, including unnecessary details and repetitive information.\n2. Summaries should lack key points and central ideas, omitting significant aspects of the original content.\n\nPOST: So I really love my girlfriend, and I want to marry her eventually, but not sure I am ready, mainly financially. I only have a part time job ($10 hr, ~30 hours a week) don't live on my own yet, and am afraid I won't be able to provide well enough as a husband. She makes less than I do. It makes me sad thinking that if we got married I may not be able to make her happy. I have a little bit of money set aside for a ring she said she wants, is it too soon to get engaged and then save up for a while on the wedding/honeymoon? (If I do this, how do I find out her ring size while still keeping it a surprise?) Also involving timing, I just graduated from college and she has one semester left.\n\nA smaller thing is we have been arguing a lot lately about stupid things, like her snapping at me and constantly calling me names for what I think is no reason. I usually bottle it up until it gets to a point where I get really upset and eventually blow up and yell. When this happens it dies down for about 2 weeks and then the cycle continues. Is this bad or normal? I really do love her.\n\nSummary:The post discusses the author's relationship with their girlfriend and their concerns about their financial situation and ability to provide for her. The author expresses their desire to marry their girlfriend but is unsure if they are ready, particularly due to their financial situation. The author also mentions their concerns about their girlfriend's behavior, specifically her snapping at them and calling them names. The author expresses their love for their girlfriend and asks for advice on how to handle their financial situation and their relationship issues."}
Loaded model on rank 3
Loaded reference model on rank 3
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Loaded model on rank 4
Loaded reference model on rank 4
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Loaded model on rank 5
Loaded reference model on rank 5
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Loaded model on rank 1
Loaded reference model on rank 1
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Loaded model on rank 6
Loaded reference model on rank 6
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Loaded model on rank 7
Loaded reference model on rank 7
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Loaded model on rank 2
Loaded reference model on rank 2
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
2000
tokenized 2000 training examples...
Loaded model on rank 0
Loaded reference model on rank 0
Writing checkpoints to /scr/jphilipp/typo/trained_models/Mistral-7B-v0.1/checkpoints-summarization/typo-5e-7-iteration-4-from-epoch-0.2.
Epoch 0, Step 0: train/loss = 0.6853213310241699, train/raw-loss = 0.6853213310241699, train/logprobs = tensor([[-0.5949, -0.5006],
        [-0.6393, -0.5022]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 1: train/loss = 0.6943533420562744, train/raw-loss = 0.6943533420562744, train/logprobs = tensor([[-0.6967, -0.5945],
        [-0.7291, -0.6143]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 2: train/loss = 0.6938371062278748, train/raw-loss = 0.6938371062278748, train/logprobs = tensor([[-0.6695, -0.6432],
        [-0.6964, -0.6652]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 3: train/loss = 0.6896713972091675, train/raw-loss = 0.6896713972091675, train/logprobs = tensor([[-0.7391, -0.6893],
        [-0.7790, -0.7114]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 4: train/loss = 0.6874734163284302, train/raw-loss = 0.6874734163284302, train/logprobs = tensor([[-0.7162, -0.6304],
        [-0.7658, -0.6489]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 5: train/loss = 0.6884247660636902, train/raw-loss = 0.6884247660636902, train/logprobs = tensor([[-0.6811, -0.6072],
        [-0.7189, -0.6167]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 6: train/loss = 0.6888426542282104, train/raw-loss = 0.6888426542282104, train/logprobs = tensor([[-0.6912, -0.6628],
        [-0.7253, -0.6767]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 7: train/loss = 0.691543459892273, train/raw-loss = 0.691543459892273, train/logprobs = tensor([[-0.6757, -0.5951],
        [-0.6959, -0.6033]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 8: train/loss = 0.6878246665000916, train/raw-loss = 0.6878246665000916, train/logprobs = tensor([[-0.7253, -0.6208],
        [-0.7688, -0.6362]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 9: train/loss = 0.6896999478340149, train/raw-loss = 0.6896999478340149, train/logprobs = tensor([[-0.7876, -0.6710],
        [-0.8345, -0.6940]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 10: train/loss = 0.6923904418945312, train/raw-loss = 0.6923904418945312, train/logprobs = tensor([[-0.7320, -0.6735],
        [-0.7509, -0.6803]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 11: train/loss = 0.6904774308204651, train/raw-loss = 0.6904774308204651, train/logprobs = tensor([[-0.6566, -0.5992],
        [-0.6979, -0.6225]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 12: train/loss = 0.6937237977981567, train/raw-loss = 0.6937237977981567, train/logprobs = tensor([[-0.7065, -0.6216],
        [-0.7430, -0.6418]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 13: train/loss = 0.6914875507354736, train/raw-loss = 0.6914875507354736, train/logprobs = tensor([[-0.5694, -0.4795],
        [-0.5900, -0.4830]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 14: train/loss = 0.6906463503837585, train/raw-loss = 0.6906463503837585, train/logprobs = tensor([[-0.6162, -0.5641],
        [-0.6431, -0.5777]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 15: train/loss = 0.6880212426185608, train/raw-loss = 0.6880212426185608, train/logprobs = tensor([[-0.7406, -0.7015],
        [-0.7703, -0.7077]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 16: train/loss = 0.6942088007926941, train/raw-loss = 0.6942088007926941, train/logprobs = tensor([[-0.6672, -0.6153],
        [-0.6926, -0.6347]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 17: train/loss = 0.6942148208618164, train/raw-loss = 0.6942148208618164, train/logprobs = tensor([[-0.6901, -0.5942],
        [-0.7365, -0.6240]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 18: train/loss = 0.6927503943443298, train/raw-loss = 0.6927503943443298, train/logprobs = tensor([[-0.7610, -0.6067],
        [-0.8209, -0.6403]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 19: train/loss = 0.6913781762123108, train/raw-loss = 0.6913781762123108, train/logprobs = tensor([[-0.6799, -0.6430],
        [-0.7014, -0.6505]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 20: train/loss = 0.6917088627815247, train/raw-loss = 0.6917088627815247, train/logprobs = tensor([[-0.6232, -0.6190],
        [-0.6454, -0.6309]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 21: train/loss = 0.6892552375793457, train/raw-loss = 0.6892552375793457, train/logprobs = tensor([[-0.7023, -0.6143],
        [-0.7369, -0.6292]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 22: train/loss = 0.6906742453575134, train/raw-loss = 0.6906742453575134, train/logprobs = tensor([[-0.7431, -0.7309],
        [-0.7832, -0.7537]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 23: train/loss = 0.6878157258033752, train/raw-loss = 0.6878157258033752, train/logprobs = tensor([[-0.7398, -0.7010],
        [-0.7777, -0.7147]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
Epoch 0, Step 24: train/loss = 0.6887683868408203, train/raw-loss = 0.6887683868408203, train/logprobs = tensor([[-0.6623, -0.5631],
        [-0.7085, -0.5854]], device='cuda:0', grad_fn=<DivBackward0>), KL = 0.0
