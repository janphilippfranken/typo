{'model': {'model_type': 'huggingface', 'name': 'llama_70b_base', 'model_config': {'pretrained_model_name_or_path': 'meta-llama/Meta-Llama-3-70B', 'cache_dir': '/scr/jphilipp/sami-online/pretrained_models/Meta-Llama-3-70B'}, 'tokenizer_config': {'pretrained_model_name_or_path': 'meta-llama/Meta-Llama-3-70B', 'cache_dir': '/scr/jphilipp/sami-online/pretrained_models/Meta-Llama-3-70B', 'model_max_length': 2048}}, 'data_path': 'data/iteration_2', 'data_file': 'iteration_2_llama_70_from_opus_principles_diverse_NO_COT_NO_PROMPT.json', 'n_examples': 2000, 'n_responses': 2, 'n_constitutions': 2, 'wandb': {'project': 'typo-summarization-llama-70', 'name': 'typo-lr-5e-7-iteration-3-opus-diverse', 'log': True}, 'typo': {'beta': 0.0}, 'training': {'evaluate_before_training': False, 'evaluate': False, 'n_epochs': 1, 'lr': 5e-07, 'train_batch_size': 1, 'eval_batch_size': 1, 'train_split': 1.0, 'checkpoint_dir': '/scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT', 'max_grad_norm': 1.0, 'num_warmup_steps': 1, 'gradient_accumulation_steps': 16, 'save_after_n_steps': 32, 'seed': 42, 'model_archive': None}}
WORLD SIZE 8 MODEL {'pretrained_model_name_or_path': 'meta-llama/Meta-Llama-3-70B', 'cache_dir': '/scr/jphilipp/sami-online/pretrained_models/Meta-Llama-3-70B'}
setting RLIMIT_NOFILE soft limit to 131072 from 1024
3 initializing distributed
wrapping model 3...
wrapped model 3...
RMSprop
Loaded model on rank 3
Loaded reference model on rank 3
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
0 initializing distributed
Initialized process group...
WANDB
wrapping model 0...
wrapped model 0...
n examples: 2000
2000
tokenized 2000 training examples...
RMSprop
Loaded model on rank 0
Loaded reference model on rank 0
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
5 initializing distributed
wrapping model 5...
wrapped model 5...
RMSprop
Loaded model on rank 5
Loaded reference model on rank 5
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
1 initializing distributed
wrapping model 1...
wrapped model 1...
RMSprop
Loaded model on rank 1
Loaded reference model on rank 1
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
7 initializing distributed
wrapping model 7...
wrapped model 7...
RMSprop
Loaded model on rank 7
Loaded reference model on rank 7
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
6 initializing distributed
wrapping model 6...
wrapped model 6...
RMSprop
Loaded model on rank 6
Loaded reference model on rank 6
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
4 initializing distributed
wrapping model 4...
wrapped model 4...
RMSprop
Loaded model on rank 4
Loaded reference model on rank 4
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
2 initializing distributed
wrapping model 2...
wrapped model 2...
RMSprop
Loaded model on rank 2
Loaded reference model on rank 2
Writing checkpoints to /scr/jphilipp/typo/trained_models/Meta-Llama-3-70B/checkpoints-sumarization-NO-COT/typo-5e-7-iteration-3-opus-diverse-NO-PROMPT.
