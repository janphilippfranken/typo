[2024-02-27 14:02:34,024][root][INFO] - beta: 0.5
[2024-02-27 14:02:34,024][root][INFO] - loss with_labels
[2024-02-27 14:02:34,024][root][INFO] - max_iter: 0
[2024-02-27 14:02:34,024][root][INFO] - writing checkpoints to: /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-per-token-kl
clearing gpu cache for all ranks
Model with 7241.732096M params prepared
n helpful: 5000
n harmless: 5000
Loaded model on rank 1
Loaded reference model on rank 1
Writing checkpoints to /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-per-token-kl after each epoch.
tokenized 9500 training examples...
train dataset has 9500 examples.
eval dataset has 500 examples.
Loaded model on rank 0
Loaded reference model on rank 0
Writing checkpoints to /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-per-token-kl after each epoch.
Loaded model on rank 3
Loaded reference model on rank 3
Writing checkpoints to /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-per-token-kl after each epoch.
Loaded model on rank 2
Loaded reference model on rank 2
Writing checkpoints to /scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-per-token-kl after each epoch.
> /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/loss_functions.py(106)kl_divergence_from_logits_per_token()
-> for i in range(logprobs_policy_logits.shape[0]):
(Pdb) 
FAILED TO COMPUTE KLD
> /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/loss_functions.py(106)kl_divergence_from_logits_per_token()
-> for i in range(logprobs_policy_logits.shape[0]):
(Pdb) 
FAILED TO COMPUTE KLD
> /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/loss_functions.py(106)kl_divergence_from_logits_per_token()
-> for i in range(logprobs_policy_logits.shape[0]):
(Pdb) 
FAILED TO COMPUTE KLD
> /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/loss_functions.py(106)kl_divergence_from_logits_per_token()
-> for i in range(logprobs_policy_logits.shape[0]):
(Pdb) 
FAILED TO COMPUTE KLD
