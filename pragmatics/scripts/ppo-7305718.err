[2024-02-24 14:56:30,303] torch.distributed.run: [WARNING] 
[2024-02-24 14:56:30,303] torch.distributed.run: [WARNING] *****************************************
[2024-02-24 14:56:30,303] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-02-24 14:56:30,303] torch.distributed.run: [WARNING] *****************************************
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: janphilipp-franken. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/wandb/run-20240224_145635-xtq1ahnu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run beta-0.5-with-labels
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai-with-labels
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai-with-labels/runs/xtq1ahnu
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/wandb/run-20240224_145635-1wla9kf6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run beta-0.5-with-labels
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai-with-labels
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai-with-labels/runs/1wla9kf6
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/wandb/run-20240224_145635-tf2iuw9d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run beta-0.5-with-labels
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai-with-labels
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai-with-labels/runs/tf2iuw9d
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /sailhome/jphilipp/research_projects/scai-tuning/pragmatics/wandb/run-20240224_145635-17al5xr7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run beta-0.5-with-labels
wandb: ‚≠êÔ∏è View project at https://wandb.ai/janphilipp-franken/scai-with-labels
wandb: üöÄ View run at https://wandb.ai/janphilipp-franken/scai-with-labels/runs/17al5xr7
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.72s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.61s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.58s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.67s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:10<00:00,  4.73s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:10<00:00,  5.03s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.66s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.95s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.63s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.92s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.63s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.94s/it]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.72s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.74s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.64s/it]Loading checkpoint shards:  50%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 1/2 [00:06<00:06,  6.62s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.50s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.83s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.52s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.86s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.47s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.79s/it]
Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.45s/it]Loading checkpoint shards: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2/2 [00:09<00:00,  4.78s/it]
Error executing job with overrides: ['ppo.beta=0.5', 'ppo.max_iter=0', 'wandb.name=beta-0.5-with-labels', 'training.checkpoint_dir=/scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-with-labels']
Error executing job with overrides: ['ppo.beta=0.5', 'ppo.max_iter=0', 'wandb.name=beta-0.5-with-labels', 'training.checkpoint_dir=/scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-with-labels']
Traceback (most recent call last):
  File "/sailhome/jphilipp/research_projects/scai-tuning/pragmatics/train.py", line 138, in main
    dataset_dict_helpful = json.load(open(os.path.join(args.data.data_path, args.data.helpful)))
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 293, in load
    return loads(fp.read(),
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 148145 column 25 (char 20195237)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Traceback (most recent call last):
  File "/sailhome/jphilipp/research_projects/scai-tuning/pragmatics/train.py", line 138, in main
    dataset_dict_helpful = json.load(open(os.path.join(args.data.data_path, args.data.helpful)))
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 293, in load
    return loads(fp.read(),
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 148145 column 25 (char 20195237)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Error executing job with overrides: ['ppo.beta=0.5', 'ppo.max_iter=0', 'wandb.name=beta-0.5-with-labels', 'training.checkpoint_dir=/scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-with-labels']
Error executing job with overrides: ['ppo.beta=0.5', 'ppo.max_iter=0', 'wandb.name=beta-0.5-with-labels', 'training.checkpoint_dir=/scr/jphilipp/scai/trained_models/Mistral-7B-v0.1/checkpoints/ppo-beta-0.5-with-labels']
Traceback (most recent call last):
  File "/sailhome/jphilipp/research_projects/scai-tuning/pragmatics/train.py", line 138, in main
    dataset_dict_helpful = json.load(open(os.path.join(args.data.data_path, args.data.helpful)))
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 293, in load
    return loads(fp.read(),
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 148145 column 25 (char 20195237)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
Traceback (most recent call last):
  File "/sailhome/jphilipp/research_projects/scai-tuning/pragmatics/train.py", line 138, in main
    dataset_dict_helpful = json.load(open(os.path.join(args.data.data_path, args.data.helpful)))
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 293, in load
    return loads(fp.read(),
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 148145 column 25 (char 20195237)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
wandb: - 0.015 MB of 0.015 MB uploadedwandb: - 0.015 MB of 0.015 MB uploadedwandb: - 0.015 MB of 0.015 MB uploadedwandb: \ 0.015 MB of 0.015 MB uploadedwandb: \ 0.015 MB of 0.015 MB uploadedwandb: \ 0.015 MB of 0.015 MB uploadedwandb: | 0.015 MB of 0.015 MB uploadedwandb: | 0.015 MB of 0.015 MB uploadedwandb: üöÄ View run beta-0.5-with-labels at: https://wandb.ai/janphilipp-franken/scai-with-labels/runs/tf2iuw9d
wandb: Ô∏è‚ö° View job at https://wandb.ai/janphilipp-franken/scai-with-labels/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjE0Mjc0NjEyOQ==/version_details/v0
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240224_145635-tf2iuw9d/logs
wandb: | 0.015 MB of 0.015 MB uploadedwandb: / 0.015 MB of 0.015 MB uploadedwandb: üöÄ View run beta-0.5-with-labels at: https://wandb.ai/janphilipp-franken/scai-with-labels/runs/17al5xr7
wandb: Ô∏è‚ö° View job at https://wandb.ai/janphilipp-franken/scai-with-labels/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjE0Mjc0NjEyOQ==/version_details/v0
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240224_145635-17al5xr7/logs
wandb: üöÄ View run beta-0.5-with-labels at: https://wandb.ai/janphilipp-franken/scai-with-labels/runs/xtq1ahnu
wandb: Ô∏è‚ö° View job at https://wandb.ai/janphilipp-franken/scai-with-labels/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjE0Mjc0NjEyOQ==/version_details/v2
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240224_145635-xtq1ahnu/logs
wandb: üöÄ View run beta-0.5-with-labels at: https://wandb.ai/janphilipp-franken/scai-with-labels/runs/1wla9kf6
wandb: Ô∏è‚ö° View job at https://wandb.ai/janphilipp-franken/scai-with-labels/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjE0Mjc0NjEyOQ==/version_details/v0
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240224_145635-1wla9kf6/logs
[2024-02-24 14:57:20,360] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 2260051) of binary: /scr/jphilipp/miniconda3/envs/scai-tuning/bin/python
Traceback (most recent call last):
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/distributed/run.py", line 806, in main
    run(args)
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/scr/jphilipp/miniconda3/envs/scai-tuning/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-02-24_14:57:20
  host      : cocoflops-hgx-1.stanford.edu
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2260052)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2024-02-24_14:57:20
  host      : cocoflops-hgx-1.stanford.edu
  rank      : 2 (local_rank: 2)
  exitcode  : 1 (pid: 2260053)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2024-02-24_14:57:20
  host      : cocoflops-hgx-1.stanford.edu
  rank      : 3 (local_rank: 3)
  exitcode  : 1 (pid: 2260054)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-02-24_14:57:20
  host      : cocoflops-hgx-1.stanford.edu
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2260051)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
